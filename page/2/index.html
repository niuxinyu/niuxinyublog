<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/niuxinyublog/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/niuxinyublog/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/niuxinyublog/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/niuxinyublog/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/niuxinyublog/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/niuxinyublog/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/niuxinyublog/',
    scheme: 'Gemini',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="文章">
<meta property="og:type" content="website">
<meta property="og:title" content="niu的blog">
<meta property="og:url" content="https://niuxinyu.github.io/niuxinyublog/page/2/index.html">
<meta property="og:site_name" content="niu的blog">
<meta property="og:description" content="文章">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="niu的blog">
<meta name="twitter:description" content="文章">
  <link rel="canonical" href="https://niuxinyu.github.io/niuxinyublog/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>niu的blog</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/niuxinyublog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">niu的blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/niuxinyublog/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/niuxinyublog/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            
  <div id="posts" class="posts-expand">
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/uni-app问题记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/uni-app问题记录/" class="post-title-link" itemprop="url">uni-app问题记录</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 19:06:55 / 修改时间：22:28:25" itemprop="dateCreated datePublished" datetime="2020-06-27T19:06:55+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="uni-app-开发中遇到的问题"><a href="#uni-app-开发中遇到的问题" class="headerlink" title="uni-app 开发中遇到的问题"></a><code>uni-app</code> 开发中遇到的问题</h1><h2 id="1-关于H5端接口跨域问题"><a href="#1-关于H5端接口跨域问题" class="headerlink" title="1. 关于H5端接口跨域问题"></a>1. 关于H5端接口跨域问题</h2><p>解决方法</p>
<p>配置 <code>manifest.json</code> 文件，在文件最后加上</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"name"</span>: <span class="string">"renderjs-echarts-demo"</span>,</span><br><span class="line">	<span class="attr">"appid"</span>: <span class="string">"__UNI__A90F8FC"</span>,</span><br><span class="line">	<span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">	<span class="attr">"versionName"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">	<span class="attr">"versionCode"</span>: <span class="string">"100"</span>,</span><br><span class="line">	<span class="attr">"transformPx"</span>: <span class="literal">false</span>,</span><br><span class="line">	<span class="comment">/* 5+App特有相关 */</span></span><br><span class="line">	<span class="attr">"app-plus"</span>: &#123;</span><br><span class="line">		<span class="attr">"compatible"</span>: &#123;</span><br><span class="line">			<span class="attr">"ignoreVersion"</span>: <span class="literal">false</span></span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">"usingComponents"</span>: <span class="literal">true</span>,</span><br><span class="line">		<span class="attr">"nvueCompiler"</span>: <span class="string">"uni-app"</span>,</span><br><span class="line">		<span class="attr">"splashscreen"</span>: &#123;</span><br><span class="line">			<span class="attr">"alwaysShowBeforeRender"</span>: <span class="literal">true</span>,</span><br><span class="line">			<span class="attr">"waiting"</span>: <span class="literal">true</span>,</span><br><span class="line">			<span class="attr">"autoclose"</span>: <span class="literal">true</span>,</span><br><span class="line">			<span class="attr">"delay"</span>: <span class="number">0</span></span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="comment">/* 模块配置 */</span></span><br><span class="line">		<span class="attr">"modules"</span>: &#123;&#125;,</span><br><span class="line">		<span class="comment">/* 应用发布信息 */</span></span><br><span class="line">		<span class="attr">"distribute"</span>: &#123;</span><br><span class="line">			<span class="comment">/* android打包配置 */</span></span><br><span class="line">			<span class="attr">"android"</span>: &#123;</span><br><span class="line">				<span class="attr">"permissions"</span>: [</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.CHANGE_NETWORK_STATE\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.MOUNT_UNMOUNT_FILESYSTEMS\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.READ_CONTACTS\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.VIBRATE\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.READ_LOGS\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-feature android:name=\"android.hardware.camera.autofocus\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.WRITE_CONTACTS\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.CAMERA\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.RECORD_AUDIO\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.GET_ACCOUNTS\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.MODIFY_AUDIO_SETTINGS\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.READ_PHONE_STATE\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.CHANGE_WIFI_STATE\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.WAKE_LOCK\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.CALL_PHONE\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.FLASHLIGHT\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-feature android:name=\"android.hardware.camera\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\"/&gt;"</span>,</span><br><span class="line">					<span class="string">"&lt;uses-permission android:name=\"android.permission.WRITE_SETTINGS\"/&gt;"</span></span><br><span class="line">				]</span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="comment">/* ios打包配置 */</span></span><br><span class="line">			<span class="attr">"ios"</span>: &#123;&#125;,</span><br><span class="line">			<span class="comment">/* SDK配置 */</span></span><br><span class="line">			<span class="attr">"sdkConfigs"</span>: &#123;</span><br><span class="line">				<span class="attr">"ad"</span>: &#123;&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">"compilerVersion"</span>: <span class="number">3</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">/* 快应用特有相关 */</span></span><br><span class="line">	<span class="attr">"quickapp"</span>: &#123;&#125;,</span><br><span class="line">	<span class="comment">/* 小程序特有相关 */</span></span><br><span class="line">	<span class="attr">"mp-weixin"</span>: &#123;</span><br><span class="line">		<span class="attr">"appid"</span>: <span class="string">""</span>,</span><br><span class="line">		<span class="attr">"setting"</span>: &#123;</span><br><span class="line">			<span class="attr">"urlCheck"</span>: <span class="literal">false</span></span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">"usingComponents"</span>: <span class="literal">true</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">"mp-alipay"</span>: &#123;</span><br><span class="line">		<span class="attr">"usingComponents"</span>: <span class="literal">true</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">"mp-baidu"</span>: &#123;</span><br><span class="line">		<span class="attr">"usingComponents"</span>: <span class="literal">true</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">"mp-toutiao"</span>: &#123;</span><br><span class="line">		<span class="attr">"usingComponents"</span>: <span class="literal">true</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">"h5"</span>: &#123;</span><br><span class="line">		<span class="attr">"devServer"</span>: &#123;</span><br><span class="line">			<span class="attr">"disableHostCheck"</span>: <span class="literal">true</span>,  <span class="comment">// 关闭host主机检查</span></span><br><span class="line">			<span class="attr">"proxy"</span>: &#123;</span><br><span class="line">				<span class="attr">"/api"</span>: &#123;</span><br><span class="line">					<span class="attr">"target"</span>: <span class="string">"http://192.168.0.113:8080"</span>,</span><br><span class="line">					<span class="attr">"changeOrigin"</span>: <span class="literal">true</span>,</span><br><span class="line">					<span class="attr">"secure"</span>: <span class="literal">false</span>,</span><br><span class="line">					<span class="attr">"pathRewrite"</span>: &#123;</span><br><span class="line">						<span class="attr">"^/api"</span>: <span class="string">""</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-关于封装了-uni-request-方法导致的手机端接口请求失败的问题"><a href="#2-关于封装了-uni-request-方法导致的手机端接口请求失败的问题" class="headerlink" title="2. 关于封装了 uni.request() 方法导致的手机端接口请求失败的问题"></a>2. 关于封装了 <code>uni.request()</code> 方法导致的手机端接口请求失败的问题</h2><p><code>uni.request</code> 封装</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = <span class="built_in">Symbol</span>(<span class="string">'config'</span>)</span><br><span class="line"><span class="keyword">const</span> isCompleteURL = <span class="built_in">Symbol</span>(<span class="string">'isCompleteURL'</span>)</span><br><span class="line"><span class="keyword">const</span> requestBefore = <span class="built_in">Symbol</span>(<span class="string">'requestBefore'</span>)</span><br><span class="line"><span class="keyword">const</span> requestAfter = <span class="built_in">Symbol</span>(<span class="string">'requestAfter'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinRequest</span> </span>&#123;</span><br><span class="line">	[config] = &#123;</span><br><span class="line">		baseURL: <span class="string">'http://192.168.0.113:8080'</span>,</span><br><span class="line">		header: &#123;</span><br><span class="line">			<span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">		&#125;,</span><br><span class="line">		method: <span class="string">'GET'</span>,</span><br><span class="line">		dataType: <span class="string">'json'</span>,</span><br><span class="line">		responseType: <span class="string">'text'</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 拦截器方法</span></span><br><span class="line">	interceptors = &#123;</span><br><span class="line">		request: <span class="function">(<span class="params">func</span>) =&gt;</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (func) &#123;</span><br><span class="line">				MinRequest[requestBefore] = func</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				MinRequest[requestBefore] = <span class="function">(<span class="params">request</span>) =&gt;</span> request</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;,</span><br><span class="line">		response: <span class="function">(<span class="params">func</span>) =&gt;</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (func) &#123;</span><br><span class="line">				MinRequest[requestAfter] = func</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				MinRequest[requestAfter] = <span class="function">(<span class="params">response</span>) =&gt;</span> response</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span>[requestBefore](config) &#123;</span><br><span class="line">		<span class="keyword">return</span> config</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span>[requestAfter](response) &#123;</span><br><span class="line">		<span class="keyword">return</span> response</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span>[isCompleteURL](url) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="regexp">/(http|https):\/\/([\w.]+\/?)\S*/</span>.test(url)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	setConfig(func) &#123;</span><br><span class="line">		<span class="keyword">this</span>[config] = func(<span class="keyword">this</span>[config])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	request(options = &#123;&#125;) &#123;</span><br><span class="line">		options.baseURL = options.baseURL || <span class="keyword">this</span>[config].baseURL</span><br><span class="line">		options.dataType = options.dataType || <span class="keyword">this</span>[config].dataType</span><br><span class="line">		<span class="comment">// options.url = MinRequest[isCompleteURL](options.url) ? options.url : (options.baseURL + options.url)</span></span><br><span class="line">		options.url = <span class="keyword">this</span>[config].baseURL + options.url</span><br><span class="line">		options.data = options.data</span><br><span class="line">		options.sslVerify = <span class="literal">false</span></span><br><span class="line">		options.header = &#123; ...options.header,</span><br><span class="line">			...this[config].header</span><br><span class="line">		&#125;</span><br><span class="line">		options.method = options.method || <span class="keyword">this</span>[config].method</span><br><span class="line"></span><br><span class="line">		options = &#123; ...options,</span><br><span class="line">			...MinRequest[requestBefore](options)</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">console</span>.log(options)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">			options.success = <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">				resolve(MinRequest[requestAfter](res))</span><br><span class="line">			&#125;</span><br><span class="line">			options.fail = <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">				<span class="built_in">console</span>.log(err)</span><br><span class="line">				reject(MinRequest[requestAfter](err))</span><br><span class="line">			&#125;</span><br><span class="line">			uni.request(options)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">get</span>(params, options = &#123;&#125;) &#123;</span><br><span class="line">		options.url = params.url</span><br><span class="line">		options.data = params.data</span><br><span class="line">		options.method = <span class="string">'GET'</span></span><br><span class="line">		options.sslVerify = <span class="literal">false</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.request(options)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	post(params, options = &#123;&#125;) &#123;</span><br><span class="line">		options.url = params.url</span><br><span class="line">		options.data = params.data</span><br><span class="line">		options.method = <span class="string">'POST'</span></span><br><span class="line">		options.sslVerify = <span class="literal">false</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.request(options)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MinRequest</span><br></pre></td></tr></table></figure>

<p>实例化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MinRequest <span class="keyword">from</span> <span class="string">'./http.js'</span></span><br><span class="line"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">'../config'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baseUrl = process.env.NODE_ENV === <span class="string">'development'</span> ? config.baseUrl.dev : config.baseUrl.pro</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> minRequest = <span class="keyword">new</span> MinRequest()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置默认配置</span></span><br><span class="line">minRequest.setConfig(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">  config.baseURL = baseUrl</span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">minRequest.interceptors.request(<span class="function">(<span class="params">request</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> request</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">minRequest.interceptors.response(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> response.data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> minRequest</span><br></pre></td></tr></table></figure>

<p><code>config</code> 配置文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *  <span class="doctag">@description </span>请求的基础路径</span></span><br><span class="line"><span class="comment">	 * **/</span></span><br><span class="line">	baseUrl: &#123;</span><br><span class="line">		<span class="comment">// 开发环境下</span></span><br><span class="line">		<span class="comment">// #ifdef APP-PLUS</span></span><br><span class="line">		dev: <span class="string">'http://192.168.0.113:8080'</span>,</span><br><span class="line">		<span class="comment">// #endif</span></span><br><span class="line">		<span class="comment">// #ifdef H5</span></span><br><span class="line">		dev: <span class="string">''</span>,</span><br><span class="line">		<span class="comment">// #endif</span></span><br><span class="line">		<span class="comment">// 生产环境</span></span><br><span class="line">		pro: <span class="string">'http://192.168.0.113:8080'</span></span><br><span class="line">	&#125;,</span><br><span class="line">	BASE_PATH: <span class="string">'/api'</span></span><br><span class="line">	<span class="comment">// BASE_PATH: ''</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于App端是不存在跨域问题的，所以在实例化的时候实际上得到的基础路径是 <code>config</code> 文件下的 <code>dev</code> 路径，也就是空，所以导致了接口请求报错。</p>
<p><code>config</code> 文件修改后，根据条件编译区分不同平台以配置不同的请求基础路径。</p>
<h2 id="3-动态设置元素高度的问题"><a href="#3-动态设置元素高度的问题" class="headerlink" title="3. 动态设置元素高度的问题"></a>3. 动态设置元素高度的问题</h2><p>问题：由于开发供热  <code>app</code> 的时候需要动态的调整两个元素的高度为其中高度的较大值，但是 <code>app</code> 端是不支持 <code>dom</code> 操作的。</p>
<p>一开始的解决办法是：</p>
<blockquote>
<p>通过 <code>this.$refs.名字</code> 获得 <code>dom</code> 元素列表数组，然后通过 <code>this.$refs.名字.$el.clientHeighht</code> 得到高度并且进行对比，最后通过 <code>this.$refs.名字.style.height</code> 设置高度为两个高度中的较大值</p>
</blockquote>
<p>但是 <code>app</code> 端是不支持 <code>dom</code> 操作的。所以无法通过  <code>$refs</code> 设置其高度。</p>
<p>最终的解决办法是：</p>
<blockquote>
<p>纯数据驱动的解决办法</p>
</blockquote>
<p>在<code>watch</code> 中添加如下代码，<code>data</code> 中定义 如下, <code>methods</code> 中定义如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">					<span class="keyword">let</span> temp = []</span><br><span class="line">					<span class="keyword">let</span> header = uni.createSelectorQuery().selectAll(<span class="string">".table-vertical-header--cell"</span>)</span><br><span class="line">					<span class="keyword">let</span> body = uni.createSelectorQuery().selectAll(<span class="string">'.table-vertical-body--cell'</span>)</span><br><span class="line">					header.boundingClientRect(<span class="function"><span class="params">header</span> =&gt;</span> &#123;</span><br><span class="line">						body.boundingClientRect(<span class="function"><span class="params">body</span> =&gt;</span> &#123;</span><br><span class="line">							header.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">								<span class="keyword">if</span> (+item.height &gt;= +body[index].height) &#123;</span><br><span class="line">									<span class="keyword">this</span>.headerCellStyle.push(+item.height - <span class="number">20</span>)</span><br><span class="line">									<span class="keyword">this</span>.bodyCellStyle.push(+item.height - <span class="number">20</span>)</span><br><span class="line">								&#125;</span><br><span class="line">								<span class="keyword">else</span> &#123;</span><br><span class="line">									<span class="keyword">this</span>.headerCellStyle.push(+body[index].height - <span class="number">20</span>)</span><br><span class="line">									<span class="keyword">this</span>.bodyCellStyle.push(+body[index].height - <span class="number">20</span>)</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;)</span><br><span class="line">						&#125;).exec()</span><br><span class="line">					&#125;).exec()</span><br><span class="line">				&#125;)</span><br><span class="line"></span><br><span class="line">data</span><br><span class="line">data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        headerCellStyle: [],</span><br><span class="line">        bodyCellStyle: []</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">methods</span><br><span class="line">methods: &#123;</span><br><span class="line">    getHeaderCellStyle (index) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            height: <span class="keyword">this</span>.headerCellStyle[index] + <span class="string">'px'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">        getBodyCellStyle (index) &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                height: <span class="keyword">this</span>.bodyCellStyle[index] + <span class="string">'px'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>之后就可以使用了</p>
<h2 id="4-关于图片引入的问题"><a href="#4-关于图片引入的问题" class="headerlink" title="4. 关于图片引入的问题"></a>4. 关于图片引入的问题</h2><p>在 <code>uni-app</code> 中引入图片的时候，<code>require</code> 的形式引入的是 图片 <code>base64</code> 格式的图片。</p>
<p>有时候在手机端 <code>base64</code> 格式的图片可能会显示出问题，所以，在手机端可以使用 <code>绝对路径来引用问题</code></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/uni-app动态设置顶部标题及底部tabbar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/uni-app动态设置顶部标题及底部tabbar/" class="post-title-link" itemprop="url">uni-app动态设置顶部标题及底部tabbar</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 19:06:00 / 修改时间：22:30:21" itemprop="dateCreated datePublished" datetime="2020-06-27T19:06:00+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>动态设置顶部标题 uni.setNavigationBarTitle 参考地址 <a href="https://uniapp.dcloud.io/api/ui/navigationbar" target="_blank" rel="noopener">https://uniapp.dcloud.io/api/ui/navigationbar</a><br>动态设置底部tabbar内容  uni.setTabBarItem 参考地址 <a href="https://uniapp.dcloud.io/api/ui/tabbar?id=settabbaritem" target="_blank" rel="noopener">https://uniapp.dcloud.io/api/ui/tabbar?id=settabbaritem</a><br>当将一个页面内写入多项内容的时候，可以在 pages.js 内将路径写死，也就是点击某一项tabbar的时候还是跳转到原来的界面，但是显示的内容会不一样</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/uni-app打包为安卓app之后tabbar图标失效的问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/uni-app打包为安卓app之后tabbar图标失效的问题/" class="post-title-link" itemprop="url">uni-app打包为安卓app之后tabbar图标失效的问题</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 19:04:56 / 修改时间：22:30:08" itemprop="dateCreated datePublished" datetime="2020-06-27T19:04:56+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在 <code>uni-app</code> 打包过程中，遇到了这样的一个问题。打包之后底部的  <code>tabbar</code> 图标消失了。一开始以为是由于编译版本和 <code>SDK</code> 版本不一致导致的，后来经过排查原因是：在  <code>pages.json</code> 文件内，<code>tabbar</code> 图标的引用路径不能以 <code>./</code> 开头。                </p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/reset-css/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/reset-css/" class="post-title-link" itemprop="url">reset css</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 19:03:19 / 修改时间：22:30:02" itemprop="dateCreated datePublished" datetime="2020-06-27T19:03:19+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><code>reset.css</code> </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* http://meyerweb.com/eric/tools/css/reset/</span></span><br><span class="line"><span class="comment">   v2.0-modified | 20110126</span></span><br><span class="line"><span class="comment">   License: none (public domain)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">html</span>, <span class="selector-tag">body</span>, <span class="selector-tag">div</span>, <span class="selector-tag">span</span>, <span class="selector-tag">applet</span>, <span class="selector-tag">object</span>, <span class="selector-tag">iframe</span>,</span><br><span class="line"><span class="selector-tag">h1</span>, <span class="selector-tag">h2</span>, <span class="selector-tag">h3</span>, <span class="selector-tag">h4</span>, <span class="selector-tag">h5</span>, <span class="selector-tag">h6</span>, <span class="selector-tag">p</span>, <span class="selector-tag">blockquote</span>, <span class="selector-tag">pre</span>,</span><br><span class="line"><span class="selector-tag">a</span>, <span class="selector-tag">abbr</span>, <span class="selector-tag">acronym</span>, <span class="selector-tag">address</span>, <span class="selector-tag">big</span>, <span class="selector-tag">cite</span>, <span class="selector-tag">code</span>,</span><br><span class="line"><span class="selector-tag">del</span>, <span class="selector-tag">dfn</span>, <span class="selector-tag">em</span>, <span class="selector-tag">img</span>, <span class="selector-tag">ins</span>, <span class="selector-tag">kbd</span>, <span class="selector-tag">q</span>, <span class="selector-tag">s</span>, <span class="selector-tag">samp</span>,</span><br><span class="line"><span class="selector-tag">small</span>, <span class="selector-tag">strike</span>, <span class="selector-tag">strong</span>, <span class="selector-tag">sub</span>, <span class="selector-tag">sup</span>, <span class="selector-tag">tt</span>, <span class="selector-tag">var</span>,</span><br><span class="line"><span class="selector-tag">b</span>, <span class="selector-tag">u</span>, <span class="selector-tag">i</span>, <span class="selector-tag">center</span>,</span><br><span class="line"><span class="selector-tag">dl</span>, <span class="selector-tag">dt</span>, <span class="selector-tag">dd</span>, <span class="selector-tag">ol</span>, <span class="selector-tag">ul</span>, <span class="selector-tag">li</span>,</span><br><span class="line"><span class="selector-tag">fieldset</span>, <span class="selector-tag">form</span>, <span class="selector-tag">label</span>, <span class="selector-tag">legend</span>,</span><br><span class="line"><span class="selector-tag">table</span>, <span class="selector-tag">caption</span>, <span class="selector-tag">tbody</span>, <span class="selector-tag">tfoot</span>, <span class="selector-tag">thead</span>, <span class="selector-tag">tr</span>, <span class="selector-tag">th</span>, <span class="selector-tag">td</span>,</span><br><span class="line"><span class="selector-tag">article</span>, <span class="selector-tag">aside</span>, <span class="selector-tag">canvas</span>, <span class="selector-tag">details</span>, <span class="selector-tag">embed</span>,</span><br><span class="line"><span class="selector-tag">figure</span>, <span class="selector-tag">figcaption</span>, <span class="selector-tag">footer</span>, <span class="selector-tag">header</span>, <span class="selector-tag">hgroup</span>,</span><br><span class="line"><span class="selector-tag">menu</span>, <span class="selector-tag">nav</span>, <span class="selector-tag">output</span>, <span class="selector-tag">ruby</span>, <span class="selector-tag">section</span>, <span class="selector-tag">summary</span>,</span><br><span class="line"><span class="selector-tag">time</span>, <span class="selector-tag">mark</span>, <span class="selector-tag">audio</span>, <span class="selector-tag">video</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">	<span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">	<span class="attribute">font-size</span>: <span class="number">100%</span>;</span><br><span class="line">	<span class="attribute">font</span>: inherit;</span><br><span class="line">	<span class="attribute">vertical-align</span>: baseline;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* make sure to set some focus styles for accessibility */</span></span><br><span class="line"><span class="selector-pseudo">:focus</span> &#123;</span><br><span class="line">    <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* HTML5 display-role reset for older browsers */</span></span><br><span class="line"><span class="selector-tag">article</span>, <span class="selector-tag">aside</span>, <span class="selector-tag">details</span>, <span class="selector-tag">figcaption</span>, <span class="selector-tag">figure</span>,</span><br><span class="line"><span class="selector-tag">footer</span>, <span class="selector-tag">header</span>, <span class="selector-tag">hgroup</span>, <span class="selector-tag">menu</span>, <span class="selector-tag">nav</span>, <span class="selector-tag">section</span> &#123;</span><br><span class="line">	<span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">	<span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ol</span>, <span class="selector-tag">ul</span> &#123;</span><br><span class="line">	<span class="attribute">list-style</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">blockquote</span>, <span class="selector-tag">q</span> &#123;</span><br><span class="line">	<span class="attribute">quotes</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">blockquote</span><span class="selector-pseudo">:before</span>, <span class="selector-tag">blockquote</span><span class="selector-pseudo">:after</span>,</span><br><span class="line"><span class="selector-tag">q</span><span class="selector-pseudo">:before</span>, <span class="selector-tag">q</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">	<span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">	<span class="attribute">content</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">table</span> &#123;</span><br><span class="line">	<span class="attribute">border-collapse</span>: collapse;</span><br><span class="line">	<span class="attribute">border-spacing</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=search]</span><span class="selector-pseudo">::-webkit-search-cancel-button</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=search]</span><span class="selector-pseudo">::-webkit-search-decoration</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=search]</span><span class="selector-pseudo">::-webkit-search-results-button</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=search]</span><span class="selector-pseudo">::-webkit-search-results-decoration</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-appearance</span>: none;</span><br><span class="line">    <span class="attribute">-moz-appearance</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=search]</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-appearance</span>: none;</span><br><span class="line">    <span class="attribute">-moz-appearance</span>: none;</span><br><span class="line">    <span class="attribute">-webkit-box-sizing</span>: content-box;</span><br><span class="line">    <span class="attribute">-moz-box-sizing</span>: content-box;</span><br><span class="line">    <span class="attribute">box-sizing</span>: content-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">textarea</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">    <span class="attribute">vertical-align</span>: top;</span><br><span class="line">    <span class="attribute">resize</span>: vertical;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">audio</span>,</span><br><span class="line"><span class="selector-tag">canvas</span>,</span><br><span class="line"><span class="selector-tag">video</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    *display: inline;</span><br><span class="line">    *<span class="selector-tag">zoom</span>: 1;</span><br><span class="line">    <span class="selector-tag">max-width</span>: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Prevent modern browsers from displaying `audio` without controls.</span></span><br><span class="line"><span class="comment"> * Remove excess height in iOS 5 devices.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">audio</span><span class="selector-pseudo">:not(</span><span class="selector-attr">[controls]</span>) &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.</span></span><br><span class="line"><span class="comment"> * Known issue: no IE 6 support.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[hidden]</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. Correct text resizing oddly in IE 6/7 when body `font-size` is set using</span></span><br><span class="line"><span class="comment"> *    `em` units.</span></span><br><span class="line"><span class="comment"> * 2. Prevent iOS text size adjust after orientation change, without disabling</span></span><br><span class="line"><span class="comment"> *    user zoom.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">100%</span>; <span class="comment">/* 1 */</span></span><br><span class="line">    <span class="attribute">-webkit-text-size-adjust</span>: <span class="number">100%</span>; <span class="comment">/* 2 */</span></span><br><span class="line">    <span class="attribute">-ms-text-size-adjust</span>: <span class="number">100%</span>; <span class="comment">/* 2 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Address `outline` inconsistency between Chrome and other browsers.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:focus</span> &#123;</span><br><span class="line">    <span class="attribute">outline</span>: thin dotted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Improve readability when focused and also mouse hovered in all browsers.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:active</span>,</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.</span></span><br><span class="line"><span class="comment"> * 2. Improve image quality when scaled in IE 7.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>; <span class="comment">/* 1 */</span></span><br><span class="line">    <span class="attribute">-ms-interpolation-mode</span>: bicubic; <span class="comment">/* 2 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">figure</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Correct margin displayed oddly in IE 6/7.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">form</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Define consistent border, margin, and padding.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">fieldset</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#c0c0c0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.35em</span> <span class="number">0.625em</span> <span class="number">0.75em</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. Correct color not being inherited in IE 6/7/8/9.</span></span><br><span class="line"><span class="comment"> * 2. Correct text not wrapping in Firefox 3.</span></span><br><span class="line"><span class="comment"> * 3. Correct alignment displayed oddly in IE 6/7.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">legend</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>; <span class="comment">/* 1 */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">white-space</span>: normal; <span class="comment">/* 2 */</span></span><br><span class="line">    *margin-left: -7px; /* 3 */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. Correct font size not being inherited in all browsers.</span></span><br><span class="line"><span class="comment"> * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,</span></span><br><span class="line"><span class="comment"> *    and Chrome.</span></span><br><span class="line"><span class="comment"> * 3. Improve appearance and consistency in all browsers.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span>,</span><br><span class="line"><span class="selector-tag">input</span>,</span><br><span class="line"><span class="selector-tag">select</span>,</span><br><span class="line"><span class="selector-tag">textarea</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">100%</span>; <span class="comment">/* 1 */</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/* 2 */</span></span><br><span class="line">    <span class="attribute">vertical-align</span>: baseline; <span class="comment">/* 3 */</span></span><br><span class="line">    *vertical-align: middle; /* 3 */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Address Firefox 3+ setting `line-height` on `input` using `!important` in</span></span><br><span class="line"><span class="comment"> * the UA stylesheet.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span>,</span><br><span class="line"><span class="selector-tag">input</span> &#123;</span><br><span class="line">    <span class="attribute">line-height</span>: normal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Address inconsistent `text-transform` inheritance for `button` and `select`.</span></span><br><span class="line"><span class="comment"> * All other form control elements do not inherit `text-transform` values.</span></span><br><span class="line"><span class="comment"> * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.</span></span><br><span class="line"><span class="comment"> * Correct `select` style inheritance in Firefox 4+ and Opera.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span>,</span><br><span class="line"><span class="selector-tag">select</span> &#123;</span><br><span class="line">    <span class="attribute">text-transform</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`</span></span><br><span class="line"><span class="comment"> *    and `video` controls.</span></span><br><span class="line"><span class="comment"> * 2. Correct inability to style clickable `input` types in iOS.</span></span><br><span class="line"><span class="comment"> * 3. Improve usability and consistency of cursor style between image-type</span></span><br><span class="line"><span class="comment"> *    `input` and others.</span></span><br><span class="line"><span class="comment"> * 4. Remove inner spacing in IE 7 without affecting normal text inputs.</span></span><br><span class="line"><span class="comment"> *    Known issue: inner spacing remains in IE 6.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span>,</span><br><span class="line"><span class="selector-tag">html</span> <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">"button"</span>]</span>, <span class="comment">/* 1 */</span></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">"reset"</span>]</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">"submit"</span>]</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-appearance</span>: button; <span class="comment">/* 2 */</span></span><br><span class="line">    <span class="attribute">cursor</span>: pointer; <span class="comment">/* 3 */</span></span><br><span class="line">    *overflow: visible;  /* 4 */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Re-set default cursor for disabled elements.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-attr">[disabled]</span>,</span><br><span class="line"><span class="selector-tag">html</span> <span class="selector-tag">input</span><span class="selector-attr">[disabled]</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: default;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. Address box sizing set to content-box in IE 8/9.</span></span><br><span class="line"><span class="comment"> * 2. Remove excess padding in IE 8/9.</span></span><br><span class="line"><span class="comment"> * 3. Remove excess padding in IE 7.</span></span><br><span class="line"><span class="comment"> *    Known issue: excess padding remains in IE 6.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">"checkbox"</span>]</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">"radio"</span>]</span> &#123;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box; <span class="comment">/* 1 */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>; <span class="comment">/* 2 */</span></span><br><span class="line">    *height: 13px; /* 3 */</span><br><span class="line">    *<span class="selector-tag">width</span>: 13<span class="selector-tag">px</span>; <span class="comment">/* 3 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.</span></span><br><span class="line"><span class="comment"> * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome</span></span><br><span class="line"><span class="comment"> *    (include `-moz` to future-proof).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">"search"</span>]</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-appearance</span>: textfield; <span class="comment">/* 1 */</span></span><br><span class="line">    <span class="attribute">-moz-box-sizing</span>: content-box;</span><br><span class="line">    <span class="attribute">-webkit-box-sizing</span>: content-box; <span class="comment">/* 2 */</span></span><br><span class="line">    <span class="attribute">box-sizing</span>: content-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Remove inner padding and search cancel button in Safari 5 and Chrome</span></span><br><span class="line"><span class="comment"> * on OS X.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">"search"</span>]</span><span class="selector-pseudo">::-webkit-search-cancel-button</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">"search"</span>]</span><span class="selector-pseudo">::-webkit-search-decoration</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-appearance</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Remove inner padding and border in Firefox 3+.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-pseudo">::-moz-focus-inner</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">::-moz-focus-inner</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. Remove default vertical scrollbar in IE 6/7/8/9.</span></span><br><span class="line"><span class="comment"> * 2. Improve readability and alignment in all browsers.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">textarea</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: auto; <span class="comment">/* 1 */</span></span><br><span class="line">    <span class="attribute">vertical-align</span>: top; <span class="comment">/* 2 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Remove most spacing between table cells.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">table</span> &#123;</span><br><span class="line">    <span class="attribute">border-collapse</span>: collapse;</span><br><span class="line">    <span class="attribute">border-spacing</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">button</span>,</span><br><span class="line"><span class="selector-tag">input</span>,</span><br><span class="line"><span class="selector-tag">select</span>,</span><br><span class="line"><span class="selector-tag">textarea</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#222</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-moz-selection</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#b3d4fc</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::selection</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#b3d4fc</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">fieldset</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">textarea</span> &#123;</span><br><span class="line">    <span class="attribute">resize</span>: vertical;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.chromeframe</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0.2em</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ccc</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.2em</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/require-context自动导入文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/require-context自动导入文件/" class="post-title-link" itemprop="url">require.context自动导入文件</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 19:02:21 / 修改时间：22:29:55" itemprop="dateCreated datePublished" datetime="2020-06-27T19:02:21+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="require-context-自动导入"><a href="#require-context-自动导入" class="headerlink" title="require.context 自动导入"></a>require.context 自动导入</h1><blockquote>
<p>如果你的 require参数含有表达式(expressions)，会创建一个上下文(context)，因为在编译时(compile time)并不清楚具体是哪一个模块被导入</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">"./template/"</span> + name + <span class="string">".ejs"</span>);</span><br></pre></td></tr></table></figure>

<p>webpack 解析 require() 的调用，提取出来如下这些信息：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Directory: ./template</span><br><span class="line">Regular expression: <span class="regexp">/^.*\.ejs$/</span></span><br></pre></td></tr></table></figure>

<p>则会返回template目录下的所有后缀为.ejs模块的引用，包含子目录。</p>
<h1 id="require-context"><a href="#require-context" class="headerlink" title="require.context"></a>require.context</h1><p>可以使用 require.context() 方法来创建自己的（模块）上下文，这个方法有 3 个参数：</p>
<ul>
<li>要搜索的文件夹目录</li>
<li>是否还应该搜索它的子目录，</li>
<li>以及一个匹配文件的正则表达式。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>.context(directory, useSubdirectories = <span class="literal">false</span>, regExp = <span class="regexp">/^\.\//</span>)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>.context(<span class="string">"./test"</span>, <span class="literal">false</span>, /\.test\.js$/);</span><br><span class="line"><span class="comment">//（创建了）一个包含了 test 文件夹（不包含子目录）下面的、所有文件名以 `.test.js` 结尾的、能被 require 请求到的文件的上下文。</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>.context(<span class="string">"../"</span>, <span class="literal">true</span>, /\.stories\.js$/);</span><br><span class="line"><span class="comment">//（创建了）一个包含了父级文件夹（包含子目录）下面，所有文件名以 `.stories.js` 结尾的文件的上下文。</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>require.context模块导出（返回）一个（require）函数</strong>，这个函数可以接收一个参数：request 函数–这里的 request 应该是指在 require() 语句中的表达式</p>
</blockquote>
<p>导出的方法有 3 个属性： resolve, keys, id。</p>
<ul>
<li>resolve 是一个函数，它返回请求被解析后得到的模块 id。</li>
<li>keys 也是一个函数，它返回一个数组，由所有可能被上下文模块处理的请求组成。</li>
<li>id 是上下文模块里面所包含的模块 id. 它可能在你使用 module.hot.accept 的时候被用到</li>
</ul>
<p>Vue 全局组件：</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/qs-stringify和qs-parse之间的区别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/qs-stringify和qs-parse之间的区别/" class="post-title-link" itemprop="url">qs.stringify和qs.parse之间的区别</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 19:00:18 / 修改时间：22:29:49" itemprop="dateCreated datePublished" datetime="2020-06-27T19:00:18+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Qs库"><a href="#Qs库" class="headerlink" title="Qs库"></a>Qs库</h2><p><a href="https://www.npmjs.com/package/qs" target="_blank" rel="noopener">Qs npm</a></p>
<ul>
<li><p><code>qs.stringify</code>  将会把传递的 参数 序列化为 <code>URL</code> 的形式， 以 <code>&amp;</code> 进行拼接</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Qs = <span class="built_in">require</span>(<span class="string">'qs'</span>);</span><br><span class="line"><span class="keyword">let</span> obj= &#123;</span><br><span class="line">     method: <span class="string">"query_sql_dataset_data"</span>,</span><br><span class="line">     projectId: <span class="string">"85"</span>,</span><br><span class="line">     appToken: <span class="string">"7d22e38e-5717-11e7-907b-a6006ad3dba0"</span>,</span><br><span class="line">     datasetId: <span class="string">" 12564701"</span></span><br><span class="line">   &#125;;</span><br><span class="line">Qs.stringify(obj);</span><br><span class="line"><span class="built_in">console</span>.log(Qs.stringify(obj));</span><br></pre></td></tr></table></figure>

<p>以上代码的执行结果为</p>
<p><img src="https://raw.githubusercontent.com/niuxinyu/typoraimg/master/20171024193840259" alt="这里写图片描述"></p>
</li>
<li><p><code>qs.parse</code> 将会把传递的参数解析为对象的形式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Qs = <span class="built_in">require</span>(<span class="string">'qs'</span>);</span><br><span class="line"><span class="keyword">let</span> url = <span class="string">'method=query_sql_dataset_data&amp;projectId=85&amp;appToken=7d22e38e-5717-11e7-907b-a6006ad3dba0'</span>;</span><br><span class="line">Qs.parse(url);</span><br><span class="line"><span class="built_in">console</span>.log(Qs.parse(url));</span><br></pre></td></tr></table></figure>

<p>以上代码执行结果为</p>
<p><img src="https://raw.githubusercontent.com/niuxinyu/typoraimg/master/20171024193823925" alt="这里写图片描述"></p>
</li>
</ul>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/JS工具函数集/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/JS工具函数集/" class="post-title-link" itemprop="url">JS工具函数集</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 18:59:36 / 修改时间：22:29:36" itemprop="dateCreated datePublished" datetime="2020-06-27T18:59:36+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="JS-工具函数合集"><a href="#JS-工具函数合集" class="headerlink" title="JS 工具函数合集"></a>JS 工具函数合集</h1><h2 id="为元素添加on方法"><a href="#为元素添加on方法" class="headerlink" title="为元素添加on方法"></a>为元素添加on方法</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Element.prototype.on = Element.prototype.addEventListener;</span><br><span class="line"></span><br><span class="line">NodeList.prototype.on = <span class="function"><span class="keyword">function</span> (<span class="params">event, fn</span>) </span>&#123;、</span><br><span class="line">    [][<span class="string">'forEach'</span>].call(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        el.on(event, fn);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 次方法将会在 dom 元素及 NodeList 集合绑定 on方法，生产中慎用</span></span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">'#btn'</span>).on(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">666</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 批量为dom绑定事件</span></span><br><span class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">'button'</span>).on(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">666</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="为元素添加-trigger-方法"><a href="#为元素添加-trigger-方法" class="headerlink" title="为元素添加 trigger 方法"></a>为元素添加 trigger 方法</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Element.prototype.trigger = <span class="function"><span class="keyword">function</span>(<span class="params">type, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> event = <span class="built_in">document</span>.createEvent(<span class="string">"HTMLEvents"</span>);</span><br><span class="line">  event.initEvent(type, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">  event.data = data || &#123;&#125;;</span><br><span class="line">  event.eventName = type;</span><br><span class="line">  event.target = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">this</span>.dispatchEvent(event);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NodeList.prototype.trigger = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  [][<span class="string">"forEach"</span>].call(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">    el[<span class="string">"trigger"</span>](event);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用方法和 绑定事件的 on 一样</span></span><br></pre></td></tr></table></figure>

<h2 id="转义html标签"><a href="#转义html标签" class="headerlink" title="转义html标签"></a>转义html标签</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HtmlEncode</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> text</span><br><span class="line">    .replace(<span class="regexp">/&amp;/g</span>, <span class="string">"&amp;"</span>)</span><br><span class="line">    .replace(<span class="regexp">/\"/g</span>, <span class="string">'"'</span>)</span><br><span class="line">    .replace(<span class="regexp">/&lt;/g</span>, <span class="string">"&lt;"</span>)</span><br><span class="line">    .replace(<span class="regexp">/&gt;/g</span>, <span class="string">"&gt;"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="HTML标签转义"><a href="#HTML标签转义" class="headerlink" title="HTML标签转义"></a>HTML标签转义</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HTML 标签转义</span></span><br><span class="line"><span class="comment">// @param &#123;Array.&lt;DOMString&gt;&#125; templateData 字符串类型的tokens</span></span><br><span class="line"><span class="comment">// @param &#123;...&#125; ..vals 表达式占位符的运算结果tokens</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SaferHTML</span>(<span class="params">templateData</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> s = templateData[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> arg = <span class="built_in">String</span>(<span class="built_in">arguments</span>[i]);</span><br><span class="line">    <span class="comment">// Escape special characters in the substitution.</span></span><br><span class="line">    s += arg</span><br><span class="line">      .replace(<span class="regexp">/&amp;/g</span>, <span class="string">"&amp;amp;"</span>)</span><br><span class="line">      .replace(<span class="regexp">/&lt;/g</span>, <span class="string">"&amp;lt;"</span>)</span><br><span class="line">      .replace(<span class="regexp">/&gt;/g</span>, <span class="string">"&amp;gt;"</span>);</span><br><span class="line">    <span class="comment">// Don't escape special characters in the template.</span></span><br><span class="line">    s += templateData[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="keyword">var</span> html = SaferHTML<span class="string">`&lt;p&gt;这是关于字符串模板的介绍&lt;/p&gt;`</span>;</span><br></pre></td></tr></table></figure>

<h2 id="跨浏览器绑定事件"><a href="#跨浏览器绑定事件" class="headerlink" title="跨浏览器绑定事件"></a>跨浏览器绑定事件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEventSamp</span>(<span class="params">obj, evt, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!oTarget) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (obj.addEventListener) &#123;</span><br><span class="line">    obj.addEventListener(evt, fn, <span class="literal">false</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj.attachEvent) &#123;</span><br><span class="line">    obj.attachEvent(<span class="string">"on"</span> + evt, fn);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    oTarget[<span class="string">"on"</span> + sEvtType] = fn;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="加入收藏夹"><a href="#加入收藏夹" class="headerlink" title="加入收藏夹"></a>加入收藏夹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFavorite</span>(<span class="params">sURL, sTitle</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.external.addFavorite(sURL, sTitle);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="built_in">window</span>.sidebar.addPanel(sTitle, sURL, <span class="string">""</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      alert(<span class="string">"加入收藏失败，请使用Ctrl+D进行添加"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="提取页面代码中所有网址"><a href="#提取页面代码中所有网址" class="headerlink" title="提取页面代码中所有网址"></a>提取页面代码中所有网址</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aa = <span class="built_in">document</span>.documentElement.outerHTML</span><br><span class="line">  .match(</span><br><span class="line">    /(url\(|src=|href=)[\<span class="string">"\']*([^\"\'\(\)\&lt;\&gt;\[\] ]+)[\"\'\)]*|(http:\/\/[\w\-\.]+[^\"\'\(\)\&lt;\&gt;\[\] ]+)/gi</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">  .join("</span>\r\n<span class="string">")</span></span><br><span class="line"><span class="string">  .replace(/^(src=|href=|url\()[\"\']*|[\"\'\&gt;\) ]*$/gim, "</span><span class="string">");</span></span><br><span class="line"><span class="string">alert(aa);</span></span><br></pre></td></tr></table></figure>

<h2 id="动态加载脚本文件"><a href="#动态加载脚本文件" class="headerlink" title="动态加载脚本文件"></a>动态加载脚本文件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">appendscript</span>(<span class="params">src, text, reload, charset</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> id = hash(src + text);</span><br><span class="line">  <span class="keyword">if</span> (!reload &amp;&amp; in_array(id, evalscripts)) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span> (reload &amp;&amp; $(id)) &#123;</span><br><span class="line">    $(id).parentNode.removeChild($(id));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  evalscripts.push(id);</span><br><span class="line">  <span class="keyword">var</span> scriptNode = <span class="built_in">document</span>.createElement(<span class="string">"script"</span>);</span><br><span class="line">  scriptNode.type = <span class="string">"text/javascript"</span>;</span><br><span class="line">  scriptNode.id = id;</span><br><span class="line">  scriptNode.charset = charset</span><br><span class="line">    ? charset</span><br><span class="line">    : BROWSER.firefox</span><br><span class="line">    ? <span class="built_in">document</span>.characterSet</span><br><span class="line">    : <span class="built_in">document</span>.charset;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (src) &#123;</span><br><span class="line">      scriptNode.src = src;</span><br><span class="line">      scriptNode.onloadDone = <span class="literal">false</span>;</span><br><span class="line">      scriptNode.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        scriptNode.onloadDone = <span class="literal">true</span>;</span><br><span class="line">        JSLOADED[src] = <span class="number">1</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">      scriptNode.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          (scriptNode.readyState == <span class="string">"loaded"</span> ||</span><br><span class="line">            scriptNode.readyState == <span class="string">"complete"</span>) &amp;&amp;</span><br><span class="line">          !scriptNode.onloadDone</span><br><span class="line">        ) &#123;</span><br><span class="line">          scriptNode.onloadDone = <span class="literal">true</span>;</span><br><span class="line">          JSLOADED[src] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (text) &#123;</span><br><span class="line">      scriptNode.text = text;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">document</span>.getElementsByTagName(<span class="string">"head"</span>)[<span class="number">0</span>].appendChild(scriptNode);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="返回顶部的通用方法"><a href="#返回顶部的通用方法" class="headerlink" title="返回顶部的通用方法"></a>返回顶部的通用方法</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">backTop</span>(<span class="params">btnId</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(btnId);</span><br><span class="line">  <span class="keyword">var</span> d = <span class="built_in">document</span>.documentElement;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="built_in">document</span>.body;</span><br><span class="line">  <span class="built_in">window</span>.onscroll = <span class="keyword">set</span>;</span><br><span class="line">  btn.style.display = "none";</span><br><span class="line">  btn.onclick = function() &#123;</span><br><span class="line">    btn.style.display = <span class="string">"none"</span>;</span><br><span class="line">    <span class="built_in">window</span>.onscroll = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">this</span>.timer = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      d.scrollTop -= <span class="built_in">Math</span>.ceil((d.scrollTop + b.scrollTop) * <span class="number">0.1</span>);</span><br><span class="line">      b.scrollTop -= <span class="built_in">Math</span>.ceil((d.scrollTop + b.scrollTop) * <span class="number">0.1</span>);</span><br><span class="line">      <span class="keyword">if</span> (d.scrollTop + b.scrollTop == <span class="number">0</span>)</span><br><span class="line">        clearInterval(btn.timer, (<span class="built_in">window</span>.onscroll = <span class="keyword">set</span>));</span><br><span class="line">    &#125;, 10);</span><br><span class="line">  &#125;;</span><br><span class="line">  function <span class="keyword">set</span>() &#123;</span><br><span class="line">    btn.style.display = d.scrollTop + b.scrollTop &gt; <span class="number">100</span> ? <span class="string">"block"</span> : <span class="string">"none"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">backTop(<span class="string">"goTop"</span>);</span><br></pre></td></tr></table></figure>

<h2 id="实现base64解码"><a href="#实现base64解码" class="headerlink" title="实现base64解码"></a>实现base64解码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base64_decode</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> b64 = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span>;</span><br><span class="line">  <span class="keyword">var</span> o1,</span><br><span class="line">    o2,</span><br><span class="line">    o3,</span><br><span class="line">    h1,</span><br><span class="line">    h2,</span><br><span class="line">    h3,</span><br><span class="line">    h4,</span><br><span class="line">    bits,</span><br><span class="line">    i = <span class="number">0</span>,</span><br><span class="line">    ac = <span class="number">0</span>,</span><br><span class="line">    dec = <span class="string">""</span>,</span><br><span class="line">    tmp_arr = [];</span><br><span class="line">  <span class="keyword">if</span> (!data) &#123;</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;</span><br><span class="line">  data += <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    h1 = b64.indexOf(data.charAt(i++));</span><br><span class="line">    h2 = b64.indexOf(data.charAt(i++));</span><br><span class="line">    h3 = b64.indexOf(data.charAt(i++));</span><br><span class="line">    h4 = b64.indexOf(data.charAt(i++));</span><br><span class="line">    bits = (h1 &lt;&lt; <span class="number">18</span>) | (h2 &lt;&lt; <span class="number">12</span>) | (h3 &lt;&lt; <span class="number">6</span>) | h4;</span><br><span class="line">    o1 = (bits &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">    o2 = (bits &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">    o3 = bits &amp; <span class="number">0xff</span>;</span><br><span class="line">    <span class="keyword">if</span> (h3 == <span class="number">64</span>) &#123;</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(o1);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (h4 == <span class="number">64</span>) &#123;</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(o1, o2);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(o1, o2, o3);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">while</span> (i &lt; data.length);</span><br><span class="line">  dec = tmp_arr.join(<span class="string">""</span>);</span><br><span class="line">  dec = utf8_decode(dec);</span><br><span class="line">  <span class="keyword">return</span> dec;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="确认是否是键盘有效输入值"><a href="#确认是否是键盘有效输入值" class="headerlink" title="确认是否是键盘有效输入值"></a>确认是否是键盘有效输入值</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkKey</span>(<span class="params">iKey</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (iKey == <span class="number">32</span> || iKey == <span class="number">229</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="comment">/*空格和异常*/</span></span><br><span class="line">  <span class="keyword">if</span> (iKey &gt; <span class="number">47</span> &amp;&amp; iKey &lt; <span class="number">58</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="comment">/*数字*/</span></span><br><span class="line">  <span class="keyword">if</span> (iKey &gt; <span class="number">64</span> &amp;&amp; iKey &lt; <span class="number">91</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="comment">/*字母*/</span></span><br><span class="line">  <span class="keyword">if</span> (iKey &gt; <span class="number">95</span> &amp;&amp; iKey &lt; <span class="number">108</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="comment">/*数字键盘1*/</span></span><br><span class="line">  <span class="keyword">if</span> (iKey &gt; <span class="number">108</span> &amp;&amp; iKey &lt; <span class="number">112</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="comment">/*数字键盘2*/</span></span><br><span class="line">  <span class="keyword">if</span> (iKey &gt; <span class="number">185</span> &amp;&amp; iKey &lt; <span class="number">193</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="comment">/*符号1*/</span></span><br><span class="line">  <span class="keyword">if</span> (iKey &gt; <span class="number">218</span> &amp;&amp; iKey &lt; <span class="number">223</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="comment">/*符号2*/</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="全角半角转换"><a href="#全角半角转换" class="headerlink" title="全角半角转换"></a>全角半角转换</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//iCase: 0全到半，1半到全，其他不转化</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chgCase</span>(<span class="params">sStr, iCase</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    <span class="keyword">typeof</span> sStr != <span class="string">"string"</span> ||</span><br><span class="line">    sStr.length &lt;= <span class="number">0</span> ||</span><br><span class="line">    !(iCase === <span class="number">0</span> || iCase == <span class="number">1</span>)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> sStr;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> i,</span><br><span class="line">    oRs = [],</span><br><span class="line">    iCode;</span><br><span class="line">  <span class="keyword">if</span> (iCase) &#123;</span><br><span class="line">    <span class="comment">/*半-&gt;全*/</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; sStr.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">      iCode = sStr.charCodeAt(i);</span><br><span class="line">      <span class="keyword">if</span> (iCode == <span class="number">32</span>) &#123;</span><br><span class="line">        iCode = <span class="number">12288</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (iCode &lt; <span class="number">127</span>) &#123;</span><br><span class="line">        iCode += <span class="number">65248</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      oRs.push(<span class="built_in">String</span>.fromCharCode(iCode));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">/*全-&gt;半*/</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; sStr.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">      iCode = sStr.charCodeAt(i);</span><br><span class="line">      <span class="keyword">if</span> (iCode == <span class="number">12288</span>) &#123;</span><br><span class="line">        iCode = <span class="number">32</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (iCode &gt; <span class="number">65280</span> &amp;&amp; iCode &lt; <span class="number">65375</span>) &#123;</span><br><span class="line">        iCode -= <span class="number">65248</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      oRs.push(<span class="built_in">String</span>.fromCharCode(iCode));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> oRs.join(<span class="string">""</span>);</span><br><span class="line">&#125;<span class="comment">//iCase: 0全到半，1半到全，其他不转化</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chgCase</span>(<span class="params">sStr, iCase</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    <span class="keyword">typeof</span> sStr != <span class="string">"string"</span> ||</span><br><span class="line">    sStr.length &lt;= <span class="number">0</span> ||</span><br><span class="line">    !(iCase === <span class="number">0</span> || iCase == <span class="number">1</span>)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> sStr;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> i,</span><br><span class="line">    oRs = [],</span><br><span class="line">    iCode;</span><br><span class="line">  <span class="keyword">if</span> (iCase) &#123;</span><br><span class="line">    <span class="comment">/*半-&gt;全*/</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; sStr.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">      iCode = sStr.charCodeAt(i);</span><br><span class="line">      <span class="keyword">if</span> (iCode == <span class="number">32</span>) &#123;</span><br><span class="line">        iCode = <span class="number">12288</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (iCode &lt; <span class="number">127</span>) &#123;</span><br><span class="line">        iCode += <span class="number">65248</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      oRs.push(<span class="built_in">String</span>.fromCharCode(iCode));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">/*全-&gt;半*/</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; sStr.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">      iCode = sStr.charCodeAt(i);</span><br><span class="line">      <span class="keyword">if</span> (iCode == <span class="number">12288</span>) &#123;</span><br><span class="line">        iCode = <span class="number">32</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (iCode &gt; <span class="number">65280</span> &amp;&amp; iCode &lt; <span class="number">65375</span>) &#123;</span><br><span class="line">        iCode -= <span class="number">65248</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      oRs.push(<span class="built_in">String</span>.fromCharCode(iCode));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> oRs.join(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="版本对比"><a href="#版本对比" class="headerlink" title="版本对比"></a>版本对比</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compareVersion</span>(<span class="params">v1, v2</span>) </span>&#123;</span><br><span class="line">  v1 = v1.split(<span class="string">"."</span>);</span><br><span class="line">  v2 = v2.split(<span class="string">"."</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> len = <span class="built_in">Math</span>.max(v1.length, v2.length);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (v1.length &lt; len) &#123;</span><br><span class="line">    v1.push(<span class="string">"0"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (v2.length &lt; len) &#123;</span><br><span class="line">    v2.push(<span class="string">"0"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> num1 = <span class="built_in">parseInt</span>(v1[i]);</span><br><span class="line">    <span class="keyword">var</span> num2 = <span class="built_in">parseInt</span>(v2[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (num1 &gt; num2) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num1 &lt; num2) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="压缩CSS样式代码"><a href="#压缩CSS样式代码" class="headerlink" title="压缩CSS样式代码"></a>压缩CSS样式代码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compressCss</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//压缩代码</span></span><br><span class="line">  s = s.replace(<span class="regexp">/\/\*(.|\n)*?\*\//g</span>, <span class="string">""</span>); <span class="comment">//删除注释</span></span><br><span class="line">  s = s.replace(<span class="regexp">/\s*([\&#123;\&#125;\:\;\,])\s*/g</span>, <span class="string">"$1"</span>);</span><br><span class="line">  s = s.replace(<span class="regexp">/\,[\s\.\#\d]*\&#123;/g</span>, <span class="string">"&#123;"</span>); <span class="comment">//容错处理</span></span><br><span class="line">  s = s.replace(<span class="regexp">/;\s*;/g</span>, <span class="string">";"</span>); <span class="comment">//清除连续分号</span></span><br><span class="line">  s = s.match(<span class="regexp">/^\s*(\S+(\s+\S+)*)\s*$/</span>); <span class="comment">//去掉首尾空白</span></span><br><span class="line">  <span class="keyword">return</span> s == <span class="literal">null</span> ? <span class="string">""</span> : s[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取当前路径"><a href="#获取当前路径" class="headerlink" title="获取当前路径"></a>获取当前路径</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> currentPageUrl = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.href === <span class="string">"undefined"</span>) &#123;</span><br><span class="line">  currentPageUrl = <span class="built_in">document</span>.location.toString().toLowerCase();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  currentPageUrl = <span class="keyword">this</span>.href.toString().toLowerCase();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="字符串长度截取"><a href="#字符串长度截取" class="headerlink" title="字符串长度截取"></a>字符串长度截取</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cutstr</span>(<span class="params">str, len</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temp,</span><br><span class="line">        icount = <span class="number">0</span>,</span><br><span class="line">        patrn = <span class="regexp">/[^\x00-\xff]/</span>，</span><br><span class="line">        strre = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (icount &lt; len - <span class="number">1</span>) &#123;</span><br><span class="line">            temp = str.substr(i, <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (patrn.exec(temp) == <span class="literal">null</span>) &#123;</span><br><span class="line">                   icount = icount + <span class="number">1</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                icount = icount + <span class="number">2</span></span><br><span class="line">            &#125;</span><br><span class="line">            strre += temp</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> strre + <span class="string">"..."</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="时间日期格式转换"><a href="#时间日期格式转换" class="headerlink" title="时间日期格式转换"></a>时间日期格式转换</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Date</span>.prototype.format = <span class="function"><span class="keyword">function</span>(<span class="params">formatStr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> str = formatStr;</span><br><span class="line">  <span class="keyword">var</span> Week = [<span class="string">"日"</span>, <span class="string">"一"</span>, <span class="string">"二"</span>, <span class="string">"三"</span>, <span class="string">"四"</span>, <span class="string">"五"</span>, <span class="string">"六"</span>];</span><br><span class="line">  str = str.replace(<span class="regexp">/yyyy|YYYY/</span>, <span class="keyword">this</span>.getFullYear());</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /yy|YY/,</span><br><span class="line">    <span class="keyword">this</span>.getYear() % <span class="number">100</span> &gt; <span class="number">9</span></span><br><span class="line">      ? (<span class="keyword">this</span>.getYear() % <span class="number">100</span>).toString()</span><br><span class="line">      : <span class="string">"0"</span> + (<span class="keyword">this</span>.getYear() % <span class="number">100</span>)</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /MM/,</span><br><span class="line">    <span class="keyword">this</span>.getMonth() + <span class="number">1</span> &gt; <span class="number">9</span></span><br><span class="line">      ? (<span class="keyword">this</span>.getMonth() + <span class="number">1</span>).toString()</span><br><span class="line">      : <span class="string">"0"</span> + (<span class="keyword">this</span>.getMonth() + <span class="number">1</span>)</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/M/g</span>, <span class="keyword">this</span>.getMonth() + <span class="number">1</span>);</span><br><span class="line">  str = str.replace(<span class="regexp">/w|W/g</span>, Week[<span class="keyword">this</span>.getDay()]);</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /dd|DD/,</span><br><span class="line">    <span class="keyword">this</span>.getDate() &gt; <span class="number">9</span> ? <span class="keyword">this</span>.getDate().toString() : <span class="string">"0"</span> + <span class="keyword">this</span>.getDate()</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/d|D/g</span>, <span class="keyword">this</span>.getDate());</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /hh|HH/,</span><br><span class="line">    <span class="keyword">this</span>.getHours() &gt; <span class="number">9</span> ? <span class="keyword">this</span>.getHours().toString() : <span class="string">"0"</span> + <span class="keyword">this</span>.getHours()</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/h|H/g</span>, <span class="keyword">this</span>.getHours());</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /mm/,</span><br><span class="line">    <span class="keyword">this</span>.getMinutes() &gt; <span class="number">9</span></span><br><span class="line">      ? <span class="keyword">this</span>.getMinutes().toString()</span><br><span class="line">      : <span class="string">"0"</span> + <span class="keyword">this</span>.getMinutes()</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/m/g</span>, <span class="keyword">this</span>.getMinutes());</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /ss|SS/,</span><br><span class="line">    <span class="keyword">this</span>.getSeconds() &gt; <span class="number">9</span></span><br><span class="line">      ? <span class="keyword">this</span>.getSeconds().toString()</span><br><span class="line">      : <span class="string">"0"</span> + <span class="keyword">this</span>.getSeconds()</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/s|S/g</span>, <span class="keyword">this</span>.getSeconds());</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line"><span class="built_in">Date</span>.prototype.format = <span class="function"><span class="keyword">function</span>(<span class="params">format</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> o = &#123;</span><br><span class="line">    <span class="string">"M+"</span>: <span class="keyword">this</span>.getMonth() + <span class="number">1</span>, <span class="comment">//month</span></span><br><span class="line">    <span class="string">"d+"</span>: <span class="keyword">this</span>.getDate(), <span class="comment">//day</span></span><br><span class="line">    <span class="string">"h+"</span>: <span class="keyword">this</span>.getHours(), <span class="comment">//hour</span></span><br><span class="line">    <span class="string">"m+"</span>: <span class="keyword">this</span>.getMinutes(), <span class="comment">//minute</span></span><br><span class="line">    <span class="string">"s+"</span>: <span class="keyword">this</span>.getSeconds(), <span class="comment">//second</span></span><br><span class="line">    <span class="string">"q+"</span>: <span class="built_in">Math</span>.floor((<span class="keyword">this</span>.getMonth() + <span class="number">3</span>) / <span class="number">3</span>), <span class="comment">//quarter</span></span><br><span class="line">    S: <span class="keyword">this</span>.getMilliseconds() <span class="comment">//millisecond</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/(y+)/</span>.test(format))</span><br><span class="line">    format = format.replace(</span><br><span class="line">      <span class="built_in">RegExp</span>.$<span class="number">1</span>,</span><br><span class="line">      (<span class="keyword">this</span>.getFullYear() + <span class="string">""</span>).substr(<span class="number">4</span> - <span class="built_in">RegExp</span>.$<span class="number">1.</span>length)</span><br><span class="line">    );</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"("</span> + k + <span class="string">")"</span>).test(format))</span><br><span class="line">      format = format.replace(</span><br><span class="line">        <span class="built_in">RegExp</span>.$<span class="number">1</span>,</span><br><span class="line">        <span class="built_in">RegExp</span>.$<span class="number">1.</span>length == <span class="number">1</span> ? o[k] : (<span class="string">"00"</span> + o[k]).substr((<span class="string">""</span> + o[k]).length)</span><br><span class="line">      );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> format;</span><br><span class="line">&#125;;</span><br><span class="line">alert(<span class="keyword">new</span> <span class="built_in">Date</span>().format(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>));</span><br></pre></td></tr></table></figure>

<h2 id="跨浏览器删除事件"><a href="#跨浏览器删除事件" class="headerlink" title="跨浏览器删除事件"></a>跨浏览器删除事件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delEvt</span>(<span class="params">obj, evt, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (obj.addEventListener) &#123;</span><br><span class="line">    obj.addEventListener(evt, fn, <span class="literal">false</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oTarget.attachEvent) &#123;</span><br><span class="line">    obj.attachEvent(<span class="string">"on"</span> + evt, fn);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    obj[<span class="string">"on"</span> + evt] = fn;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否以某个字符串结束"><a href="#判断是否以某个字符串结束" class="headerlink" title="判断是否以某个字符串结束"></a>判断是否以某个字符串结束</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.endWith = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> d = <span class="keyword">this</span>.length - s.length;</span><br><span class="line">  <span class="keyword">return</span> d &gt;= <span class="number">0</span> &amp;&amp; <span class="keyword">this</span>.lastIndexOf(s) == d;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="返回脚本内容"><a href="#返回脚本内容" class="headerlink" title="返回脚本内容"></a>返回脚本内容</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">evalscript</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (s.indexOf(<span class="string">"&lt;script"</span>) == <span class="number">-1</span>) <span class="keyword">return</span> s;</span><br><span class="line">  <span class="keyword">var</span> p = <span class="regexp">/&lt;script[^\&gt;]*?&gt;([^\x00]*?)&lt;\/script&gt;/gi</span>;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">while</span> ((arr = p.exec(s))) &#123;</span><br><span class="line">    <span class="keyword">var</span> p1 = <span class="regexp">/&lt;script[^\&gt;]*?src=\"([^\&gt;]*?)\"[^\&gt;]*?(reload=\"1\")?(?:charset=\"([\w\-]+?)\")?&gt;&lt;\/script&gt;/i</span>;</span><br><span class="line">    <span class="keyword">var</span> arr1 = [];</span><br><span class="line">    arr1 = p1.exec(arr[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span> (arr1) &#123;</span><br><span class="line">      appendscript(arr1[<span class="number">1</span>], <span class="string">""</span>, arr1[<span class="number">2</span>], arr1[<span class="number">3</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      p1 = <span class="regexp">/&lt;script(.*?)&gt;([^\x00]+?)&lt;\/script&gt;/i</span>;</span><br><span class="line">      arr1 = p1.exec(arr[<span class="number">0</span>]);</span><br><span class="line">      appendscript(<span class="string">""</span>, arr1[<span class="number">2</span>], arr1[<span class="number">1</span>].indexOf(<span class="string">"reload="</span>) != <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="格式化CSS样式代码"><a href="#格式化CSS样式代码" class="headerlink" title="格式化CSS样式代码"></a>格式化CSS样式代码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatCss</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//格式化代码</span></span><br><span class="line">  s = s.replace(<span class="regexp">/\s*([\&#123;\&#125;\:\;\,])\s*/g</span>, <span class="string">"$1"</span>);</span><br><span class="line">  s = s.replace(<span class="regexp">/;\s*;/g</span>, <span class="string">";"</span>); <span class="comment">//清除连续分号</span></span><br><span class="line">  s = s.replace(<span class="regexp">/\,[\s\.\#\d]*&#123;/g</span>, <span class="string">"&#123;"</span>);</span><br><span class="line">  s = s.replace(<span class="regexp">/([^\s])\&#123;([^\s])/g</span>, <span class="string">"$1 &#123;\n\t$2"</span>);</span><br><span class="line">  s = s.replace(<span class="regexp">/([^\s])\&#125;([^\n]*)/g</span>, <span class="string">"$1\n&#125;\n$2"</span>);</span><br><span class="line">  s = s.replace(<span class="regexp">/([^\s]);([^\s\&#125;])/g</span>, <span class="string">"$1;\n\t$2"</span>);</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取cookie值"><a href="#获取cookie值" class="headerlink" title="获取cookie值"></a>获取cookie值</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCookie</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = <span class="built_in">document</span>.cookie.match(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^| )"</span> + name + <span class="string">"=([^;]*)(;|$)"</span>));</span><br><span class="line">  <span class="keyword">if</span> (arr != <span class="literal">null</span>) <span class="keyword">return</span> <span class="built_in">unescape</span>(arr[<span class="number">2</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获得URL中GET参数值"><a href="#获得URL中GET参数值" class="headerlink" title="获得URL中GET参数值"></a>获得URL中GET参数值</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用法：如果地址是 test.htm?t1=1&amp;t2=2&amp;t3=3, 那么能取得：GET["t1"], GET["t2"], GET["t3"]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getGet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  querystr = <span class="built_in">window</span>.location.href.split(<span class="string">"?"</span>);</span><br><span class="line">  <span class="keyword">if</span> (querystr[<span class="number">1</span>]) &#123;</span><br><span class="line">    GETs = querystr[<span class="number">1</span>].split(<span class="string">"&amp;"</span>);</span><br><span class="line">    GET = [];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; GETs.length; i++) &#123;</span><br><span class="line">      tmp_arr = GETs.split(<span class="string">"="</span>);</span><br><span class="line">      key = tmp_arr[<span class="number">0</span>];</span><br><span class="line">      GET[key] = tmp_arr[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> querystr[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取移动设备初始化大小"><a href="#获取移动设备初始化大小" class="headerlink" title="获取移动设备初始化大小"></a>获取移动设备初始化大小</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInitZoom</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>._initZoom) &#123;</span><br><span class="line">    <span class="keyword">var</span> screenWidth = <span class="built_in">Math</span>.min(screen.height, screen.width);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isAndroidMobileDevice() &amp;&amp; !<span class="keyword">this</span>.isNewChromeOnAndroid()) &#123;</span><br><span class="line">      screenWidth = screenWidth / <span class="built_in">window</span>.devicePixelRatio;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>._initZoom = screenWidth / <span class="built_in">document</span>.body.offsetWidth;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>._initZoom;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取页面高度"><a href="#获取页面高度" class="headerlink" title="获取页面高度"></a>获取页面高度</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPageHeight</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> g = <span class="built_in">document</span>,</span><br><span class="line">    a = g.body,</span><br><span class="line">    f = g.documentElement,</span><br><span class="line">    d = g.compatMode == <span class="string">"BackCompat"</span> ? a : g.documentElement;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.max(f.scrollHeight, a.scrollHeight, d.clientHeight);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取页面scrollLeft"><a href="#获取页面scrollLeft" class="headerlink" title="获取页面scrollLeft"></a>获取页面scrollLeft</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPageScrollLeft</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">document</span>;</span><br><span class="line">  <span class="keyword">return</span> a.documentElement.scrollLeft || a.body.scrollLeft;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取页面scrollTop"><a href="#获取页面scrollTop" class="headerlink" title="获取页面scrollTop"></a>获取页面scrollTop</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPageScrollTop</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">document</span>;</span><br><span class="line">  <span class="keyword">return</span> a.documentElement.scrollTop || a.body.scrollTop;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取页面可视高度"><a href="#获取页面可视高度" class="headerlink" title="获取页面可视高度"></a>获取页面可视高度</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPageViewWidth</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> d = <span class="built_in">document</span>,</span><br><span class="line">    a = d.compatMode == <span class="string">"BackCompat"</span> ? d.body : d.documentElement;</span><br><span class="line">  <span class="keyword">return</span> a.clientWidth;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取页面宽度"><a href="#获取页面宽度" class="headerlink" title="获取页面宽度"></a>获取页面宽度</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPageWidth</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> g = <span class="built_in">document</span>,</span><br><span class="line">    a = g.body,</span><br><span class="line">    f = g.documentElement,</span><br><span class="line">    d = g.compatMode == <span class="string">"BackCompat"</span> ? a : g.documentElement;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.max(f.scrollWidth, a.scrollWidth, d.clientWidth);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取移动设备屏幕宽度"><a href="#获取移动设备屏幕宽度" class="headerlink" title="获取移动设备屏幕宽度"></a>获取移动设备屏幕宽度</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getScreenWidth</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> smallerSide = <span class="built_in">Math</span>.min(screen.width, screen.height);</span><br><span class="line">  <span class="keyword">var</span> fixViewPortsExperiment =</span><br><span class="line">    rendererModel.runningExperiments.FixViewport ||</span><br><span class="line">    rendererModel.runningExperiments.fixviewport;</span><br><span class="line">  <span class="keyword">var</span> fixViewPortsExperimentRunning =</span><br><span class="line">    fixViewPortsExperiment &amp;&amp; fixViewPortsExperiment.toLowerCase() === <span class="string">"new"</span>;</span><br><span class="line">  <span class="keyword">if</span> (fixViewPortsExperiment) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isAndroidMobileDevice() &amp;&amp; !<span class="keyword">this</span>.isNewChromeOnAndroid()) &#123;</span><br><span class="line">      smallerSide = smallerSide / <span class="built_in">window</span>.devicePixelRatio;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> smallerSide;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取网页被卷去的位置"><a href="#获取网页被卷去的位置" class="headerlink" title="获取网页被卷去的位置"></a>获取网页被卷去的位置</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getScrollXY</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">document</span>.body.scrollTop</span><br><span class="line">    ? &#123;</span><br><span class="line">        x: <span class="built_in">document</span>.body.scrollLeft,</span><br><span class="line">        y: <span class="built_in">document</span>.body.scrollTop</span><br><span class="line">      &#125;</span><br><span class="line">    : &#123;</span><br><span class="line">        x: <span class="built_in">document</span>.documentElement.scrollLeft,</span><br><span class="line">        y: <span class="built_in">document</span>.documentElement.scrollTop</span><br><span class="line">      &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取URL上的参数"><a href="#获取URL上的参数" class="headerlink" title="获取URL上的参数"></a>获取URL上的参数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取URL中的某参数值,不区分大小写</span></span><br><span class="line"><span class="comment">// 获取URL中的某参数值,不区分大小写,</span></span><br><span class="line"><span class="comment">// 默认是取'hash'里的参数，</span></span><br><span class="line"><span class="comment">// 如果传其他参数支持取‘search’中的参数</span></span><br><span class="line"><span class="comment">// @param &#123;String&#125; name 参数名称</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getUrlParam</span>(<span class="params">name, type = <span class="string">"hash"</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> newName = name,</span><br><span class="line">    reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^|&amp;)"</span> + newName + <span class="string">"=([^&amp;]*)(&amp;|$)"</span>, <span class="string">"i"</span>),</span><br><span class="line">    paramHash = <span class="built_in">window</span>.location.hash.split(<span class="string">"?"</span>)[<span class="number">1</span>] || <span class="string">""</span>,</span><br><span class="line">    paramSearch = <span class="built_in">window</span>.location.search.split(<span class="string">"?"</span>)[<span class="number">1</span>] || <span class="string">""</span>,</span><br><span class="line">    param;</span><br><span class="line"></span><br><span class="line">  type === <span class="string">"hash"</span> ? (param = paramHash) : (param = paramSearch);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> result = param.match(reg);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (result != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> result[<span class="number">2</span>].split(<span class="string">"/"</span>)[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="检验URL链接是否有效"><a href="#检验URL链接是否有效" class="headerlink" title="检验URL链接是否有效"></a>检验URL链接是否有效</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUrlState</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> ActiveXObject(<span class="string">"microsoft.xmlhttp"</span>);</span><br><span class="line">  xmlhttp.Open(<span class="string">"GET"</span>, URL, <span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    xmlhttp.Send();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> result = xmlhttp.responseText;</span><br><span class="line">    <span class="keyword">if</span> (result) &#123;</span><br><span class="line">      <span class="keyword">if</span> (xmlhttp.Status == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取窗体可见范围的宽与高"><a href="#获取窗体可见范围的宽与高" class="headerlink" title="获取窗体可见范围的宽与高"></a>获取窗体可见范围的宽与高</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getViewSize</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> de = <span class="built_in">document</span>.documentElement;</span><br><span class="line">  <span class="keyword">var</span> db = <span class="built_in">document</span>.body;</span><br><span class="line">  <span class="keyword">var</span> viewW = de.clientWidth == <span class="number">0</span> ? db.clientWidth : de.clientWidth;</span><br><span class="line">  <span class="keyword">var</span> viewH = de.clientHeight == <span class="number">0</span> ? db.clientHeight : de.clientHeight;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>(viewW, viewH);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取移动设备最大化大小"><a href="#获取移动设备最大化大小" class="headerlink" title="获取移动设备最大化大小"></a>获取移动设备最大化大小</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getZoom</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> screenWidth =</span><br><span class="line">    <span class="built_in">Math</span>.abs(<span class="built_in">window</span>.orientation) === <span class="number">90</span></span><br><span class="line">      ? <span class="built_in">Math</span>.max(screen.height, screen.width)</span><br><span class="line">      : <span class="built_in">Math</span>.min(screen.height, screen.width);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.isAndroidMobileDevice() &amp;&amp; !<span class="keyword">this</span>.isNewChromeOnAndroid()) &#123;</span><br><span class="line">    screenWidth = screenWidth / <span class="built_in">window</span>.devicePixelRatio;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> FixViewPortsExperiment =</span><br><span class="line">    rendererModel.runningExperiments.FixViewport ||</span><br><span class="line">    rendererModel.runningExperiments.fixviewport;</span><br><span class="line">  <span class="keyword">var</span> FixViewPortsExperimentRunning =</span><br><span class="line">    FixViewPortsExperiment &amp;&amp;</span><br><span class="line">    (FixViewPortsExperiment === <span class="string">"New"</span> || FixViewPortsExperiment === <span class="string">"new"</span>);</span><br><span class="line">  <span class="keyword">if</span> (FixViewPortsExperimentRunning) &#123;</span><br><span class="line">    <span class="keyword">return</span> screenWidth / <span class="built_in">window</span>.innerWidth;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> screenWidth / <span class="built_in">document</span>.body.offsetWidth;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否安卓移动设备访问"><a href="#判断是否安卓移动设备访问" class="headerlink" title="判断是否安卓移动设备访问"></a>判断是否安卓移动设备访问</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isAndroidMobileDevice</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="regexp">/android/i</span>.test(navigator.userAgent.toLowerCase());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否苹果移动设备访问"><a href="#判断是否苹果移动设备访问" class="headerlink" title="判断是否苹果移动设备访问"></a>判断是否苹果移动设备访问</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isAppleMobileDevice</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="regexp">/iphone|ipod|ipad|Macintosh/i</span>.test(navigator.userAgent.toLowerCase());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否为数字类型"><a href="#判断是否为数字类型" class="headerlink" title="判断是否为数字类型"></a>判断是否为数字类型</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isDigit</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> patrn = <span class="regexp">/^[0-9]*$/</span>;</span><br><span class="line">  <span class="keyword">if</span> (patrn.exec(value) == <span class="literal">null</span> || value == <span class="string">""</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="是否是某类手机型号"><a href="#是否是某类手机型号" class="headerlink" title="是否是某类手机型号"></a>是否是某类手机型号</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用devicePixelRatio和分辨率判断</span></span><br><span class="line"><span class="keyword">const</span> isIphonex = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// X XS, XS Max, XR</span></span><br><span class="line">  <span class="keyword">const</span> xSeriesConfig = [</span><br><span class="line">    &#123;</span><br><span class="line">      devicePixelRatio: <span class="number">3</span>,</span><br><span class="line">      width: <span class="number">375</span>,</span><br><span class="line">      height: <span class="number">812</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      devicePixelRatio: <span class="number">3</span>,</span><br><span class="line">      width: <span class="number">414</span>,</span><br><span class="line">      height: <span class="number">896</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      devicePixelRatio: <span class="number">2</span>,</span><br><span class="line">      width: <span class="number">414</span>,</span><br><span class="line">      height: <span class="number">896</span></span><br><span class="line">    &#125;</span><br><span class="line">  ];</span><br><span class="line">  <span class="comment">// h5</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">"undefined"</span> &amp;&amp; <span class="built_in">window</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> isIOS = <span class="regexp">/iphone/gi</span>.test(<span class="built_in">window</span>.navigator.userAgent);</span><br><span class="line">    <span class="keyword">if</span> (!isIOS) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123; devicePixelRatio, screen &#125; = <span class="built_in">window</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123; width, height &#125; = screen;</span><br><span class="line">    <span class="keyword">return</span> xSeriesConfig.some(</span><br><span class="line">      item =&gt;</span><br><span class="line">        item.devicePixelRatio === devicePixelRatio &amp;&amp;</span><br><span class="line">        item.width === width &amp;&amp;</span><br><span class="line">        item.height === height</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否移动设备"><a href="#判断是否移动设备" class="headerlink" title="判断是否移动设备"></a>判断是否移动设备</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isMobile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>._isMobile === <span class="string">"boolean"</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._isMobile;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> screenWidth = <span class="keyword">this</span>.getScreenWidth();</span><br><span class="line">  <span class="keyword">var</span> fixViewPortsExperiment =</span><br><span class="line">    rendererModel.runningExperiments.FixViewport ||</span><br><span class="line">    rendererModel.runningExperiments.fixviewport;</span><br><span class="line">  <span class="keyword">var</span> fixViewPortsExperimentRunning =</span><br><span class="line">    fixViewPortsExperiment &amp;&amp; fixViewPortsExperiment.toLowerCase() === <span class="string">"new"</span>;</span><br><span class="line">  <span class="keyword">if</span> (!fixViewPortsExperiment) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.isAppleMobileDevice()) &#123;</span><br><span class="line">      screenWidth = screenWidth / <span class="built_in">window</span>.devicePixelRatio;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> isMobileScreenSize = screenWidth &lt; <span class="number">600</span>;</span><br><span class="line">  <span class="keyword">var</span> isMobileUserAgent = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">this</span>._isMobile = isMobileScreenSize &amp;&amp; <span class="keyword">this</span>.isTouchScreen();</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>._isMobile;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否手机号码"><a href="#判断是否手机号码" class="headerlink" title="判断是否手机号码"></a>判断是否手机号码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isMobileNumber</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i =</span><br><span class="line">      <span class="string">"134,135,136,137,138,139,150,151,152,157,158,159,187,188,147,182,183,184,178"</span>,</span><br><span class="line">    n = <span class="string">"130,131,132,155,156,185,186,145,176"</span>,</span><br><span class="line">    a = <span class="string">"133,153,180,181,189,177,173,170"</span>,</span><br><span class="line">    o = e || <span class="string">""</span>,</span><br><span class="line">    r = o.substring(<span class="number">0</span>, <span class="number">3</span>),</span><br><span class="line">    d = o.substring(<span class="number">0</span>, <span class="number">4</span>),</span><br><span class="line">    s =</span><br><span class="line">      !!<span class="regexp">/^1\d&#123;10&#125;$/</span>.test(o) &amp;&amp;</span><br><span class="line">      (n.indexOf(r) &gt;= <span class="number">0</span></span><br><span class="line">        ? <span class="string">"联通"</span></span><br><span class="line">        : a.indexOf(r) &gt;= <span class="number">0</span></span><br><span class="line">        ? <span class="string">"电信"</span></span><br><span class="line">        : <span class="string">"1349"</span> == d</span><br><span class="line">        ? <span class="string">"电信"</span></span><br><span class="line">        : i.indexOf(r) &gt;= <span class="number">0</span></span><br><span class="line">        ? <span class="string">"移动"</span></span><br><span class="line">        : <span class="string">"未知"</span>);</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否是移动设备访问"><a href="#判断是否是移动设备访问" class="headerlink" title="判断是否是移动设备访问"></a>判断是否是移动设备访问</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isMobileUserAgent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="regexp">/iphone|ipod|android.*mobile|windows.*phone|blackberry.*mobile/i</span>.test(</span><br><span class="line">    <span class="built_in">window</span>.navigator.userAgent.toLowerCase()</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断鼠标是否移出事件"><a href="#判断鼠标是否移出事件" class="headerlink" title="判断鼠标是否移出事件"></a>判断鼠标是否移出事件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isMouseOut</span>(<span class="params">e, handler</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (e.type !== <span class="string">"mouseout"</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> reltg = e.relatedTarget</span><br><span class="line">    ? e.relatedTarget</span><br><span class="line">    : e.type === <span class="string">"mouseout"</span></span><br><span class="line">    ? e.toElement</span><br><span class="line">    : e.fromElement;</span><br><span class="line">  <span class="keyword">while</span> (reltg &amp;&amp; reltg !== handler) &#123;</span><br><span class="line">    reltg = reltg.parentNode;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> reltg !== handler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否Touch屏幕"><a href="#判断是否Touch屏幕" class="headerlink" title="判断是否Touch屏幕"></a>判断是否Touch屏幕</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isTouchScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="string">"ontouchstart"</span> <span class="keyword">in</span> <span class="built_in">window</span> ||</span><br><span class="line">    (<span class="built_in">window</span>.DocumentTouch &amp;&amp; <span class="built_in">document</span> <span class="keyword">instanceof</span> DocumentTouch)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否为网址"><a href="#判断是否为网址" class="headerlink" title="判断是否为网址"></a>判断是否为网址</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isURL</span>(<span class="params">strUrl</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> regular = <span class="regexp">/^\b(((https?|ftp):\/\/)?[-a-z0-9]+(\.[-a-z0-9]+)*\.(?:com|edu|gov|int|mil|net|org|biz|info|name|museum|asia|coop|aero|[a-z][a-z]|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d))\b(\/[-a-z0-9_:\@&amp;?=+,.!\/~%\$]*)?)$/i</span>;</span><br><span class="line">  <span class="keyword">if</span> (regular.test(strUrl)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断是否打开视窗"><a href="#判断是否打开视窗" class="headerlink" title="判断是否打开视窗"></a>判断是否打开视窗</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isViewportOpen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> !!<span class="built_in">document</span>.getElementById(<span class="string">"wixMobileViewport"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="加载样式文件"><a href="#加载样式文件" class="headerlink" title="加载样式文件"></a>加载样式文件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadStyle</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.createStyleSheet(url);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">var</span> cssLink = <span class="built_in">document</span>.createElement(<span class="string">"link"</span>);</span><br><span class="line">    cssLink.rel = <span class="string">"stylesheet"</span>;</span><br><span class="line">    cssLink.type = <span class="string">"text/css"</span>;</span><br><span class="line">    cssLink.href = url;</span><br><span class="line">    <span class="keyword">var</span> head = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"head"</span>)[<span class="number">0</span>];</span><br><span class="line">    head.appendChild(cssLink);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="替换地址栏"><a href="#替换地址栏" class="headerlink" title="替换地址栏"></a>替换地址栏</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">locationReplace</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (history.replaceState) &#123;</span><br><span class="line">    history.replaceState(<span class="literal">null</span>, <span class="built_in">document</span>.title, url);</span><br><span class="line">    history.go(<span class="number">0</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    location.replace(url);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="解决offsetX兼容性问题"><a href="#解决offsetX兼容性问题" class="headerlink" title="解决offsetX兼容性问题"></a>解决offsetX兼容性问题</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 针对火狐不支持offsetX/Y</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getOffset</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> target = e.target, <span class="comment">// 当前触发的目标对象</span></span><br><span class="line">    eventCoord,</span><br><span class="line">    pageCoord,</span><br><span class="line">    offsetCoord;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计算当前触发元素到文档的距离</span></span><br><span class="line">  pageCoord = getPageCoord(target);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计算光标到文档的距离</span></span><br><span class="line">  eventCoord = &#123;</span><br><span class="line">    X: <span class="built_in">window</span>.pageXOffset + e.clientX,</span><br><span class="line">    Y: <span class="built_in">window</span>.pageYOffset + e.clientY</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 相减获取光标到第一个定位的父元素的坐标</span></span><br><span class="line">  offsetCoord = &#123;</span><br><span class="line">    X: eventCoord.X - pageCoord.X,</span><br><span class="line">    Y: eventCoord.Y - pageCoord.Y</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> offsetCoord;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPageCoord</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> coord = &#123; <span class="attr">X</span>: <span class="number">0</span>, <span class="attr">Y</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  <span class="comment">// 计算从当前触发元素到根节点为止，</span></span><br><span class="line">  <span class="comment">// 各级 offsetParent 元素的 offsetLeft 或 offsetTop 值之和</span></span><br><span class="line">  <span class="keyword">while</span> (element) &#123;</span><br><span class="line">    coord.X += element.offsetLeft;</span><br><span class="line">    coord.Y += element.offsetTop;</span><br><span class="line">    element = element.offsetParent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> coord;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="打开一个窗体通用方法"><a href="#打开一个窗体通用方法" class="headerlink" title="打开一个窗体通用方法"></a>打开一个窗体通用方法</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openWindow</span>(<span class="params">url, windowName, width, height</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x = <span class="built_in">parseInt</span>(screen.width / <span class="number">2.0</span>) - width / <span class="number">2.0</span>;</span><br><span class="line">  <span class="keyword">var</span> y = <span class="built_in">parseInt</span>(screen.height / <span class="number">2.0</span>) - height / <span class="number">2.0</span>;</span><br><span class="line">  <span class="keyword">var</span> isMSIE = navigator.appName == <span class="string">"Microsoft Internet Explorer"</span>;</span><br><span class="line">  <span class="keyword">if</span> (isMSIE) &#123;</span><br><span class="line">    <span class="keyword">var</span> p = <span class="string">"resizable=1,location=no,scrollbars=no,width="</span>;</span><br><span class="line">    p = p + width;</span><br><span class="line">    p = p + <span class="string">",height="</span>;</span><br><span class="line">    p = p + height;</span><br><span class="line">    p = p + <span class="string">",left="</span>;</span><br><span class="line">    p = p + x;</span><br><span class="line">    p = p + <span class="string">",top="</span>;</span><br><span class="line">    p = p + y;</span><br><span class="line">    retval = <span class="built_in">window</span>.open(url, windowName, p);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> win = <span class="built_in">window</span>.open(</span><br><span class="line">      url,</span><br><span class="line">      <span class="string">"ZyiisPopup"</span>,</span><br><span class="line">      <span class="string">"top="</span> +</span><br><span class="line">        y +</span><br><span class="line">        <span class="string">",left="</span> +</span><br><span class="line">        x +</span><br><span class="line">        <span class="string">",scrollbars="</span> +</span><br><span class="line">        scrollbars +</span><br><span class="line">        <span class="string">",dialog=yes,modal=yes,width="</span> +</span><br><span class="line">        width +</span><br><span class="line">        <span class="string">",height="</span> +</span><br><span class="line">        height +</span><br><span class="line">        <span class="string">",resizable=no"</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">"try &#123; win.resizeTo(width, height); &#125; catch(e) &#123; &#125;"</span>);</span><br><span class="line">    win.focus();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="将键值对拼接成URL带参数"><a href="#将键值对拼接成URL带参数" class="headerlink" title="将键值对拼接成URL带参数"></a>将键值对拼接成URL带参数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">const</span> fnParams2Url = <span class="function"><span class="params">obj</span>=&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> aUrl = []</span><br><span class="line">      <span class="keyword">let</span> fnAdd = <span class="function"><span class="keyword">function</span>(<span class="params">key, value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> key + <span class="string">'='</span> + value</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        aUrl.push(fnAdd(k, obj[k]))</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">encodeURIComponent</span>(aUrl.join(<span class="string">'&amp;'</span>))</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="去掉url前缀"><a href="#去掉url前缀" class="headerlink" title="去掉url前缀"></a>去掉url前缀</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeUrlPrefix</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  a = a</span><br><span class="line">    .replace(<span class="regexp">/：/g</span>, <span class="string">":"</span>)</span><br><span class="line">    .replace(<span class="regexp">/．/g</span>, <span class="string">"."</span>)</span><br><span class="line">    .replace(<span class="regexp">/／/g</span>, <span class="string">"/"</span>);</span><br><span class="line">  <span class="keyword">while</span> (</span><br><span class="line">    trim(a)</span><br><span class="line">      .toLowerCase()</span><br><span class="line">      .indexOf(<span class="string">"http://"</span>) == <span class="number">0</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    a = trim(a.replace(<span class="regexp">/http:\/\//i</span>, <span class="string">""</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="替换全部"><a href="#替换全部" class="headerlink" title="替换全部"></a>替换全部</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.replaceAll = <span class="function"><span class="keyword">function</span>(<span class="params">s1, s2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(s1, <span class="string">"gm"</span>), s2);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="resize的操作"><a href="#resize的操作" class="headerlink" title="resize的操作"></a>resize的操作</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> w = <span class="built_in">document</span>.documentElement</span><br><span class="line">        ? <span class="built_in">document</span>.documentElement.clientWidth</span><br><span class="line">        : <span class="built_in">document</span>.body.clientWidth,</span><br><span class="line">      r = <span class="number">1255</span>,</span><br><span class="line">      b = Element.extend(<span class="built_in">document</span>.body),</span><br><span class="line">      classname = b.className;</span><br><span class="line">    <span class="keyword">if</span> (w &lt; r) &#123;</span><br><span class="line">      <span class="comment">//当窗体的宽度小于1255的时候执行相应的操作</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//当窗体的宽度大于1255的时候执行相应的操作</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.addEventListener) &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">"resize"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      fn();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.attachEvent) &#123;</span><br><span class="line">    <span class="built_in">window</span>.attachEvent(<span class="string">"onresize"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      fn();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  fn();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h2 id="滚动到顶部"><a href="#滚动到顶部" class="headerlink" title="滚动到顶部"></a>滚动到顶部</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用document.documentElement.scrollTop 或 document.body.scrollTop 获取到顶部的距离，从顶部</span></span><br><span class="line"><span class="comment">// 滚动一小部分距离。使用window.requestAnimationFrame()来滚动。</span></span><br><span class="line"><span class="comment">// @example</span></span><br><span class="line"><span class="comment">// scrollToTop();</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scrollToTop</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> c = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (c &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(scrollToTop);</span><br><span class="line">    <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, c - c / <span class="number">8</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="设置cookie值"><a href="#设置cookie值" class="headerlink" title="设置cookie值"></a>设置cookie值</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setCookie</span>(<span class="params">name, value, Hours</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">var</span> offset = <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">var</span> utc = d.getTime() + d.getTimezoneOffset() * <span class="number">60000</span>;</span><br><span class="line">  <span class="keyword">var</span> nd = utc + <span class="number">3600000</span> * offset;</span><br><span class="line">  <span class="keyword">var</span> exp = <span class="keyword">new</span> <span class="built_in">Date</span>(nd);</span><br><span class="line">  exp.setTime(exp.getTime() + Hours * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">document</span>.cookie =</span><br><span class="line">    name +</span><br><span class="line">    <span class="string">"="</span> +</span><br><span class="line">    <span class="built_in">escape</span>(value) +</span><br><span class="line">    <span class="string">";path=/;expires="</span> +</span><br><span class="line">    exp.toGMTString() +</span><br><span class="line">    <span class="string">";domain=360doc.com;"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="设为首页"><a href="#设为首页" class="headerlink" title="设为首页"></a>设为首页</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setHomepage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">document</span>.all) &#123;</span><br><span class="line">    <span class="built_in">document</span>.body.style.behavior = <span class="string">"url(#default#homepage)"</span>;</span><br><span class="line">    <span class="built_in">document</span>.body.setHomePage(<span class="string">"http://w3cboy.com"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.sidebar) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.netscape) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        netscape.security.PrivilegeManager.enablePrivilege(</span><br><span class="line">          <span class="string">"UniversalXPConnect"</span></span><br><span class="line">        );</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        alert(</span><br><span class="line">          <span class="string">"该操作被浏览器拒绝，如果想启用该功能，请在地址栏内输入 about:config,然后将项 signed.applets.codebase_principal_support 值该为true"</span></span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> prefs = Components.classes[</span><br><span class="line">      <span class="string">"@mozilla.org/preferences-service;1"</span></span><br><span class="line">    ].getService(Components.interfaces.nsIPrefBranch);</span><br><span class="line">    prefs.setCharPref(<span class="string">"browser.startup.homepage"</span>, <span class="string">"http://w3cboy.com"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="按字母排序，对每行进行数组排序"><a href="#按字母排序，对每行进行数组排序" class="headerlink" title="按字母排序，对每行进行数组排序"></a>按字母排序，对每行进行数组排序</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setSort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> text = K1.value</span><br><span class="line">    .split(<span class="regexp">/[\r\n]/</span>)</span><br><span class="line">    .sort()</span><br><span class="line">    .join(<span class="string">"\r\n"</span>); <span class="comment">//顺序</span></span><br><span class="line">  <span class="keyword">var</span> test = K1.value</span><br><span class="line">    .split(<span class="regexp">/[\r\n]/</span>)</span><br><span class="line">    .sort()</span><br><span class="line">    .reverse()</span><br><span class="line">    .join(<span class="string">"\r\n"</span>); <span class="comment">//反序</span></span><br><span class="line">  K1.value = K1.value != text ? text : test;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="延时执行"><a href="#延时执行" class="headerlink" title="延时执行"></a>延时执行</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 比如 sleep(1000) 意味着等待1000毫秒，还可从 Promise、Generator、Async/Await 等角度实现。</span></span><br><span class="line"><span class="comment">// Promise</span></span><br><span class="line"><span class="keyword">const</span> sleep = <span class="function"><span class="params">time</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve, time));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1000</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generator</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">sleepGenerator</span>(<span class="params">time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    setTimeout(resolve, time);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sleepGenerator(<span class="number">1000</span>)</span><br><span class="line">  .next()</span><br><span class="line">  .value.then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//async</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve, time));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> out = <span class="keyword">await</span> sleep(<span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">callback, time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> callback === <span class="string">"function"</span>) &#123;</span><br><span class="line">    setTimeout(callback, time);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sleep(output, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<h2 id="判断是否以某个字符串开头"><a href="#判断是否以某个字符串开头" class="headerlink" title="判断是否以某个字符串开头"></a>判断是否以某个字符串开头</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.startWith = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.indexOf(s) == <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="清除脚本内容"><a href="#清除脚本内容" class="headerlink" title="清除脚本内容"></a>清除脚本内容</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">stripscript</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> s.replace(<span class="regexp">/&lt;script.*?&gt;.*?&lt;\/script&gt;/gi</span>, <span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="时间个性化输出功能"><a href="#时间个性化输出功能" class="headerlink" title="时间个性化输出功能"></a>时间个性化输出功能</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1、&lt; 60s, 显示为“刚刚”</span></span><br><span class="line"><span class="comment">2、&gt;= 1min &amp;&amp; &lt; 60 min, 显示与当前时间差“XX分钟前”</span></span><br><span class="line"><span class="comment">3、&gt;= 60min &amp;&amp; &lt; 1day, 显示与当前时间差“今天 XX:XX”</span></span><br><span class="line"><span class="comment">4、&gt;= 1day &amp;&amp; &lt; 1year, 显示日期“XX月XX日 XX:XX”</span></span><br><span class="line"><span class="comment">5、&gt;= 1year, 显示具体日期“XXXX年XX月XX日 XX:XX”</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeFormat</span>(<span class="params">time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(time),</span><br><span class="line">    curDate = <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">    year = date.getFullYear(),</span><br><span class="line">    month = date.getMonth() + <span class="number">10</span>,</span><br><span class="line">    day = date.getDate(),</span><br><span class="line">    hour = date.getHours(),</span><br><span class="line">    minute = date.getMinutes(),</span><br><span class="line">    curYear = curDate.getFullYear(),</span><br><span class="line">    curHour = curDate.getHours(),</span><br><span class="line">    timeStr;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (year &lt; curYear) &#123;</span><br><span class="line">    timeStr = year + <span class="string">"年"</span> + month + <span class="string">"月"</span> + day + <span class="string">"日 "</span> + hour + <span class="string">":"</span> + minute;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> pastTime = curDate - date,</span><br><span class="line">      pastH = pastTime / <span class="number">3600000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pastH &gt; curHour) &#123;</span><br><span class="line">      timeStr = month + <span class="string">"月"</span> + day + <span class="string">"日 "</span> + hour + <span class="string">":"</span> + minute;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pastH &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">      timeStr = <span class="string">"今天 "</span> + hour + <span class="string">":"</span> + minute + <span class="string">"分"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> pastM = curDate.getMinutes() - minute;</span><br><span class="line">      <span class="keyword">if</span> (pastM &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        timeStr = pastM + <span class="string">"分钟前"</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        timeStr = <span class="string">"刚刚"</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> timeStr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="全角转换为半角函数"><a href="#全角转换为半角函数" class="headerlink" title="全角转换为半角函数"></a>全角转换为半角函数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toCDB</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length; i++) &#123;</span><br><span class="line">    code = str.charCodeAt(i);</span><br><span class="line">    <span class="keyword">if</span> (code &gt;= <span class="number">65281</span> &amp;&amp; code &lt;= <span class="number">65374</span>) &#123;</span><br><span class="line">      result += <span class="built_in">String</span>.fromCharCode(str.charCodeAt(i) - <span class="number">65248</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code == <span class="number">12288</span>) &#123;</span><br><span class="line">      result += <span class="built_in">String</span>.fromCharCode(str.charCodeAt(i) - <span class="number">12288</span> + <span class="number">32</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      result += str.charAt(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="半角转换为全角函数"><a href="#半角转换为全角函数" class="headerlink" title="半角转换为全角函数"></a>半角转换为全角函数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toDBC</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length; i++) &#123;</span><br><span class="line">    code = str.charCodeAt(i);</span><br><span class="line">    <span class="keyword">if</span> (code &gt;= <span class="number">33</span> &amp;&amp; code &lt;= <span class="number">126</span>) &#123;</span><br><span class="line">      result += <span class="built_in">String</span>.fromCharCode(str.charCodeAt(i) + <span class="number">65248</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code == <span class="number">32</span>) &#123;</span><br><span class="line">      result += <span class="built_in">String</span>.fromCharCode(str.charCodeAt(i) + <span class="number">12288</span> - <span class="number">32</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      result += str.charAt(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="金额大写转换函数"><a href="#金额大写转换函数" class="headerlink" title="金额大写转换函数"></a>金额大写转换函数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transform</span>(<span class="params">tranvalue</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> dw2 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">""</span>, <span class="string">"万"</span>, <span class="string">"亿"</span>); <span class="comment">//大单位</span></span><br><span class="line">    <span class="keyword">var</span> dw1 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"拾"</span>, <span class="string">"佰"</span>, <span class="string">"仟"</span>); <span class="comment">//小单位</span></span><br><span class="line">    <span class="keyword">var</span> dw = <span class="keyword">new</span> <span class="built_in">Array</span>(</span><br><span class="line">      <span class="string">"零"</span>,</span><br><span class="line">      <span class="string">"壹"</span>,</span><br><span class="line">      <span class="string">"贰"</span>,</span><br><span class="line">      <span class="string">"叁"</span>,</span><br><span class="line">      <span class="string">"肆"</span>,</span><br><span class="line">      <span class="string">"伍"</span>,</span><br><span class="line">      <span class="string">"陆"</span>,</span><br><span class="line">      <span class="string">"柒"</span>,</span><br><span class="line">      <span class="string">"捌"</span>,</span><br><span class="line">      <span class="string">"玖"</span></span><br><span class="line">    );</span><br><span class="line">    <span class="comment">//整数部分用</span></span><br><span class="line">    <span class="comment">//以下是小写转换成大写显示在合计大写的文本框中</span></span><br><span class="line">    <span class="comment">//分离整数与小数</span></span><br><span class="line">    <span class="keyword">var</span> source = splits(tranvalue);</span><br><span class="line">    <span class="keyword">var</span> num = source[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> dig = source[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//转换整数部分</span></span><br><span class="line">    <span class="keyword">var</span> k1 = <span class="number">0</span>; <span class="comment">//计小单位</span></span><br><span class="line">    <span class="keyword">var</span> k2 = <span class="number">0</span>; <span class="comment">//计大单位</span></span><br><span class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">var</span> len = source[<span class="number">0</span>].length; <span class="comment">//整数的长度</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= len; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> n = source[<span class="number">0</span>].charAt(len - i); <span class="comment">//取得某个位数上的数字</span></span><br><span class="line">      <span class="keyword">var</span> bn = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> (len - i - <span class="number">1</span> &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        bn = source[<span class="number">0</span>].charAt(len - i - <span class="number">1</span>); <span class="comment">//取得某个位数前一位上的数字</span></span><br><span class="line">      &#125;</span><br><span class="line">      sum = sum + <span class="built_in">Number</span>(n);</span><br><span class="line">      <span class="keyword">if</span> (sum != <span class="number">0</span>) &#123;</span><br><span class="line">        str = dw[<span class="built_in">Number</span>(n)].concat(str); <span class="comment">//取得该数字对应的大写数字，并插入到str字符串的前面</span></span><br><span class="line">        <span class="keyword">if</span> (n == <span class="string">"0"</span>) sum = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (len - i - <span class="number">1</span> &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//在数字范围内</span></span><br><span class="line">        <span class="keyword">if</span> (k1 != <span class="number">3</span>) &#123;</span><br><span class="line">          <span class="comment">//加小单位</span></span><br><span class="line">          <span class="keyword">if</span> (bn != <span class="number">0</span>) &#123;</span><br><span class="line">            str = dw1[k1].concat(str);</span><br><span class="line">          &#125;</span><br><span class="line">          k1++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">//不加小单位，加大单位</span></span><br><span class="line">          k1 = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">var</span> temp = str.charAt(<span class="number">0</span>);</span><br><span class="line">          <span class="keyword">if</span> (temp == <span class="string">"万"</span> || temp == <span class="string">"亿"</span>)</span><br><span class="line">            <span class="comment">//若大单位前没有数字则舍去大单位</span></span><br><span class="line">            str = str.substr(<span class="number">1</span>, str.length - <span class="number">1</span>);</span><br><span class="line">          str = dw2[k2].concat(str);</span><br><span class="line">          sum = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (k1 == <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="comment">//小单位到千则大单位进一</span></span><br><span class="line">        k2++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//转换小数部分</span></span><br><span class="line">    <span class="keyword">var</span> strdig = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">if</span> (dig != <span class="string">""</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> n = dig.charAt(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span> (n != <span class="number">0</span>) &#123;</span><br><span class="line">        strdig += dw[<span class="built_in">Number</span>(n)] + <span class="string">"角"</span>; <span class="comment">//加数字</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> n = dig.charAt(<span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> (n != <span class="number">0</span>) &#123;</span><br><span class="line">        strdig += dw[<span class="built_in">Number</span>(n)] + <span class="string">"分"</span>; <span class="comment">//加数字</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    str += <span class="string">"元"</span> + strdig;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"0元"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//拆分整数与小数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">splits</span>(<span class="params">tranvalue</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> value = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">""</span>, <span class="string">""</span>);</span><br><span class="line">  temp = tranvalue.split(<span class="string">"."</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; temp.length; i++) &#123;</span><br><span class="line">    value = temp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="清除空格"><a href="#清除空格" class="headerlink" title="清除空格"></a>清除空格</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.trim = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> reExtraSpace = <span class="regexp">/^\s*(.*?)\s+$/</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.replace(reExtraSpace, <span class="string">"$1"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清除左空格</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ltrim</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> s.replace(<span class="regexp">/^(\s*|　*)/</span>, <span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清除右空格</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rtrim</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> s.replace(<span class="regexp">/(\s*|　*)$/</span>, <span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="随机数时间戳"><a href="#随机数时间戳" class="headerlink" title="随机数时间戳"></a>随机数时间戳</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueId</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">Math</span>.random,</span><br><span class="line">    b = <span class="built_in">parseInt</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="built_in">Number</span>(<span class="keyword">new</span> <span class="built_in">Date</span>()).toString() + b(<span class="number">10</span> * a()) + b(<span class="number">10</span> * a()) + b(<span class="number">10</span> * a())</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="实现utf8解码"><a href="#实现utf8解码" class="headerlink" title="实现utf8解码"></a>实现utf8解码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">utf8_decode</span>(<span class="params">str_data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> tmp_arr = [],</span><br><span class="line">    i = <span class="number">0</span>,</span><br><span class="line">    ac = <span class="number">0</span>,</span><br><span class="line">    c1 = <span class="number">0</span>,</span><br><span class="line">    c2 = <span class="number">0</span>,</span><br><span class="line">    c3 = <span class="number">0</span>;</span><br><span class="line">  str_data += <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">while</span> (i &lt; str_data.length) &#123;</span><br><span class="line">    c1 = str_data.charCodeAt(i);</span><br><span class="line">    <span class="keyword">if</span> (c1 &lt; <span class="number">128</span>) &#123;</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(c1);</span><br><span class="line">      i++;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c1 &gt; <span class="number">191</span> &amp;&amp; c1 &lt; <span class="number">224</span>) &#123;</span><br><span class="line">      c2 = str_data.charCodeAt(i + <span class="number">1</span>);</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(((c1 &amp; <span class="number">31</span>) &lt;&lt; <span class="number">6</span>) | (c2 &amp; <span class="number">63</span>));</span><br><span class="line">      i += <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      c2 = str_data.charCodeAt(i + <span class="number">1</span>);</span><br><span class="line">      c3 = str_data.charCodeAt(i + <span class="number">2</span>);</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(</span><br><span class="line">        ((c1 &amp; <span class="number">15</span>) &lt;&lt; <span class="number">12</span>) | ((c2 &amp; <span class="number">63</span>) &lt;&lt; <span class="number">6</span>) | (c3 &amp; <span class="number">63</span>)</span><br><span class="line">      );</span><br><span class="line">      i += <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> tmp_arr.join(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以下是Puxiao投稿推荐的几个函数，用作常见的输入值校验和替换操作，主要针对中国大陆地区的校验规则：</p>
<h2 id="校验是否为一个数字，以及该数字小数点位数是否与参数floats一致"><a href="#校验是否为一个数字，以及该数字小数点位数是否与参数floats一致" class="headerlink" title="校验是否为一个数字，以及该数字小数点位数是否与参数floats一致"></a>校验是否为一个数字，以及该数字小数点位数是否与参数floats一致</h2><p>校验规则：</p>
<ul>
<li>若参数floats有值，则校验该数字小数点后的位数。</li>
<li>若参数floats没有值，则仅仅校验是否为数字。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNum</span>(<span class="params">value,floats=null</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`^[1-9][0-9]*.[0-9]&#123;<span class="subst">$&#123;floats&#125;</span>&#125;$|^0.[0-9]&#123;<span class="subst">$&#123;floats&#125;</span>&#125;$`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; floats?regexp.test(<span class="built_in">String</span>(value)):<span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anysicIntLength</span>(<span class="params">minLength,maxLength</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> result_str = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">if</span>(minLength)&#123;</span><br><span class="line">        <span class="keyword">switch</span>(maxLength)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="literal">undefined</span>:</span><br><span class="line">                result_str = result_str.concat(<span class="string">`&#123;<span class="subst">$&#123;minLength<span class="number">-1</span>&#125;</span>&#125;`</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="literal">null</span>:</span><br><span class="line">                result_str = result_str.concat(<span class="string">`&#123;<span class="subst">$&#123;minLength<span class="number">-1</span>&#125;</span>,&#125;`</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                result_str = result_str.concat(<span class="string">`&#123;<span class="subst">$&#123;minLength<span class="number">-1</span>&#125;</span>,<span class="subst">$&#123;maxLength<span class="number">-1</span>&#125;</span>&#125;`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        result_str = result_str.concat(<span class="string">'*'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result_str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为非零的正整数"><a href="#校验是否为非零的正整数" class="headerlink" title="校验是否为非零的正整数"></a>校验是否为非零的正整数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isInt</span>(<span class="params">value,minLength=null,maxLength=undefined</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!isNum(value)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`^-?[1-9][0-9]<span class="subst">$&#123;anysicIntLength(minLength,maxLength)&#125;</span>$`</span>);</span><br><span class="line">    <span class="keyword">return</span> regexp.test(value.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为非零的正整数-1"><a href="#校验是否为非零的正整数-1" class="headerlink" title="校验是否为非零的正整数"></a>校验是否为非零的正整数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPInt</span>(<span class="params">value,minLength=null,maxLength=undefined</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!isNum(value)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`^[1-9][0-9]<span class="subst">$&#123;anysicIntLength(minLength,maxLength)&#125;</span>$`</span>);</span><br><span class="line">    <span class="keyword">return</span> regexp.test(value.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为非零的负整数"><a href="#校验是否为非零的负整数" class="headerlink" title="校验是否为非零的负整数"></a>校验是否为非零的负整数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNInt</span>(<span class="params">value,minLength=null,maxLength=undefined</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!isNum(value)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">let</span> regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`^-[1-9][0-9]<span class="subst">$&#123;anysicIntLength(minLength,maxLength)&#125;</span>$`</span>);</span><br><span class="line">    <span class="keyword">return</span> regexp.test(value.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验整数是否在取值范围内"><a href="#校验整数是否在取值范围内" class="headerlink" title="校验整数是否在取值范围内"></a>校验整数是否在取值范围内</h2><p>校验规则：</p>
<ul>
<li>minInt为在取值范围中最小的整数</li>
<li>maxInt为在取值范围中最大的整数</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkIntRange</span>(<span class="params">value,minInt,maxInt=<span class="number">9007199254740991</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Boolean</span>(isInt(value) &amp;&amp; (<span class="built_in">Boolean</span>(minInt!=<span class="literal">undefined</span> &amp;&amp; minInt!=<span class="literal">null</span>)?value&gt;=minInt:<span class="literal">true</span>) &amp;&amp; (value&lt;=maxInt));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为中国大陆手机号"><a href="#校验是否为中国大陆手机号" class="headerlink" title="校验是否为中国大陆手机号"></a>校验是否为中国大陆手机号</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isTel</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^1[3,4,5,6,7,8,9][0-9]&#123;9&#125;$/</span>.test(value.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为中国大陆传真或固定电话号码"><a href="#校验是否为中国大陆传真或固定电话号码" class="headerlink" title="校验是否为中国大陆传真或固定电话号码"></a>校验是否为中国大陆传真或固定电话号码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFax</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^([0-9]&#123;3,4&#125;)?[0-9]&#123;7,8&#125;$|^([0-9]&#123;3,4&#125;-)?[0-9]&#123;7,8&#125;$/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为邮箱地址"><a href="#校验是否为邮箱地址" class="headerlink" title="校验是否为邮箱地址"></a>校验是否为邮箱地址</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isEmail</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为QQ号码"><a href="#校验是否为QQ号码" class="headerlink" title="校验是否为QQ号码"></a>校验是否为QQ号码</h2><p>校验规则：</p>
<ul>
<li>非0开头的5位-13位整数</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isQQ</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^[1-9][0-9]&#123;4,12&#125;$/</span>.test(value.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为网址"><a href="#校验是否为网址" class="headerlink" title="校验是否为网址"></a>校验是否为网址</h2><p>校验规则：</p>
<ul>
<li>以https://、http://、ftp://、rtsp://、mms://开头、或者没有这些开头</li>
<li>可以没有www开头(或其他二级域名)，仅域名</li>
<li>网页地址中允许出现/%*?@&amp;等其他允许的符号</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isURL</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^(https:\/\/|http:\/\/|ftp:\/\/|rtsp:\/\/|mms:\/\/)?[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+[\/=\?%\-&amp;_~`@[\]\':+!]*([^&lt;&gt;\"\"])*$/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为不含端口号的IP地址"><a href="#校验是否为不含端口号的IP地址" class="headerlink" title="校验是否为不含端口号的IP地址"></a>校验是否为不含端口号的IP地址</h2><p>校验规则：</p>
<ul>
<li>IP格式为xxx.xxx.xxx.xxx，每一项数字取值范围为0-255</li>
<li>除0以外其他数字不能以0开头，比如02</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isIP</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^((25[0-5]|2[0-4][0-9]|1[0-9]&#123;2&#125;|[1-9]?[0-9])\.)&#123;3&#125;(25[0-5]|2[0-4][0-9]|1[0-9]&#123;2&#125;|[1-9]?[0-9])$/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为IPv6地址"><a href="#校验是否为IPv6地址" class="headerlink" title="校验是否为IPv6地址"></a>校验是否为IPv6地址</h2><p>校验规则：</p>
<ul>
<li>支持IPv6正常格式</li>
<li>支持IPv6压缩格式</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isIPv6</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Boolean</span>(str.match(<span class="regexp">/:/g</span>)?str.match(<span class="regexp">/:/g</span>).length&lt;=<span class="number">7</span>:<span class="literal">false</span> &amp;&amp; <span class="regexp">/::/</span>.test(str)?<span class="regexp">/^([\da-f]&#123;1,4&#125;(:|::))&#123;1,6&#125;[\da-f]&#123;1,4&#125;$/i</span>.test(str):<span class="regexp">/^([\da-f]&#123;1,4&#125;:)&#123;7&#125;[\da-f]&#123;1,4&#125;$/i</span>.test(str));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为中国大陆第二代居民身份证"><a href="#校验是否为中国大陆第二代居民身份证" class="headerlink" title="校验是否为中国大陆第二代居民身份证"></a>校验是否为中国大陆第二代居民身份证</h2><p>校验规则：</p>
<ul>
<li>共18位，最后一位可为X(大小写均可)</li>
<li>不能以0开头</li>
<li>出生年月日会进行校验：年份只能为18/19/2*开头，月份只能为01-12，日只能为01-31</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isIDCard</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^[1-9][0-9]&#123;5&#125;(18|19|(2[0-9]))[0-9]&#123;2&#125;((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)[0-9]&#123;3&#125;[0-9Xx]$/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否为中国大陆邮政编码"><a href="#校验是否为中国大陆邮政编码" class="headerlink" title="校验是否为中国大陆邮政编码"></a>校验是否为中国大陆邮政编码</h2><p>参数value为数字或字符串</p>
<p>校验规则：</p>
<ul>
<li>共6位，且不能以0开头</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPostCode</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^[1-9][0-9]&#123;5&#125;$/</span>.test(value.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验两个参数是否完全相同，包括类型"><a href="#校验两个参数是否完全相同，包括类型" class="headerlink" title="校验两个参数是否完全相同，包括类型"></a>校验两个参数是否完全相同，包括类型</h2><p>校验规则：</p>
<ul>
<li>值相同，数据类型也相同</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">same</span>(<span class="params">firstValue,secondValue</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> firstValue===secondValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验字符的长度是否在规定的范围内"><a href="#校验字符的长度是否在规定的范围内" class="headerlink" title="校验字符的长度是否在规定的范围内"></a>校验字符的长度是否在规定的范围内</h2><p>校验规则：</p>
<ul>
<li>minInt为在取值范围中最小的长度</li>
<li>maxInt为在取值范围中最大的长度</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lengthRange</span>(<span class="params">str,minLength,maxLength=<span class="number">9007199254740991</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Boolean</span>(str.length &gt;= minLength &amp;&amp; str.length &lt;= maxLength);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="校验字符是否以字母开头"><a href="#校验字符是否以字母开头" class="headerlink" title="校验字符是否以字母开头"></a>校验字符是否以字母开头</h1><p>校验规则：</p>
<ul>
<li>必须以字母开头</li>
<li>开头的字母不区分大小写</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">letterBegin</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^[A-z]/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验字符是否为纯数字-整数"><a href="#校验字符是否为纯数字-整数" class="headerlink" title="校验字符是否为纯数字(整数)"></a>校验字符是否为纯数字(整数)</h2><p>校验规则：</p>
<ul>
<li>字符全部为正整数(包含0)</li>
<li>可以以0开头</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pureNum</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^[0-9]*$/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anysicPunctuation</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!str) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> arr = str.split(<span class="string">''</span>).map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> item = <span class="string">'\\'</span> + item;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> arr.join(<span class="string">'|'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPunctuation</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> anysicPunctuation(str) || <span class="string">'\\~|\\`|\\!|\\@|\\#|\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=|\\||\\\|\\[|\\]|\\&#123;|\\&#125;|\\;|\\:|\\"|\\\'|\\,|\\&lt;|\\.|\\&gt;|\\/|\\?'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getExcludePunctuation</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`[<span class="subst">$&#123;anysicPunctuation(str)&#125;</span>]`</span>,<span class="string">'g'</span>);</span><br><span class="line">    <span class="keyword">return</span> getPunctuation(<span class="string">' ~`!@#$%^&amp;*()-_+=\[]&#123;&#125;;:"\',&lt;.&gt;/?'</span>.replace(regexp,<span class="string">''</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="返回字符串构成种类-字母，数字，标点符号-的数量"><a href="#返回字符串构成种类-字母，数字，标点符号-的数量" class="headerlink" title="返回字符串构成种类(字母，数字，标点符号)的数量"></a>返回字符串构成种类(字母，数字，标点符号)的数量</h2><p>LIP缩写的由来：L(letter 字母) + I(uint 数字) + P(punctuation 标点符号)</p>
<p>参数punctuation的说明：</p>
<ul>
<li>punctuation指可接受的标点符号集</li>
<li>若需自定义符号集，例如“仅包含中划线和下划线”，将参数设置为”-_”即可</li>
<li>若不传值或默认为null，则内部默认标点符号集为除空格外的其他英文标点符号：~`!@#$%^&amp;*()-_+=[]{};:”‘,&lt;.&gt;/?</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLIPTypes</span>(<span class="params">str,punctuation=null</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> p_regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'['</span>+getPunctuation(punctuation)+<span class="string">']'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/[A-z]/</span>.test(str) + <span class="regexp">/[0-9]/</span>.test(str) + p_regexp.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验字符串构成的种类数量是否大于或等于参数num的值。通常用来校验用户设置的密码复杂程度。"><a href="#校验字符串构成的种类数量是否大于或等于参数num的值。通常用来校验用户设置的密码复杂程度。" class="headerlink" title="校验字符串构成的种类数量是否大于或等于参数num的值。通常用来校验用户设置的密码复杂程度。"></a>校验字符串构成的种类数量是否大于或等于参数num的值。通常用来校验用户设置的密码复杂程度。</h2><p>校验规则：</p>
<ul>
<li>参数num为需要构成的种类(字母、数字、标点符号)，该值只能是1-3。</li>
<li>默认参数num的值为1，即表示：至少包含字母，数字，标点符号中的1种</li>
<li>若参数num的值为2，即表示：至少包含字母，数字，标点符号中的2种</li>
<li>若参数num的值为3，即表示：必须同时包含字母，数字，标点符号</li>
<li>参数punctuation指可接受的标点符号集，具体设定可参考getLIPTypes()方法中关于标点符号集的解释。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pureLIP</span>(<span class="params">str,num=<span class="number">1</span>,punctuation=null</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`[^A-z0-9|<span class="subst">$&#123;getPunctuation(punctuation)&#125;</span>]`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Boolean</span>(!regexp.test(str) &amp;&amp; getLIPTypes(str,punctuation)&gt;= num);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="清除所有空格"><a href="#清除所有空格" class="headerlink" title="清除所有空格"></a>清除所有空格</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearSpaces</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.replace(<span class="regexp">/[ ]/g</span>,<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="清除所有中文字符-包括中文标点符号"><a href="#清除所有中文字符-包括中文标点符号" class="headerlink" title="清除所有中文字符(包括中文标点符号)"></a>清除所有中文字符(包括中文标点符号)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearCNChars</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.replace(<span class="regexp">/[\u4e00-\u9fa5]/g</span>,<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="清除所有中文字符及空格"><a href="#清除所有中文字符及空格" class="headerlink" title="清除所有中文字符及空格"></a>清除所有中文字符及空格</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearCNCharsAndSpaces</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.replace(<span class="regexp">/[\u4e00-\u9fa5 ]/g</span>,<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="除保留标点符号集以外，清除其他所有英文的标点符号-含空格"><a href="#除保留标点符号集以外，清除其他所有英文的标点符号-含空格" class="headerlink" title="除保留标点符号集以外，清除其他所有英文的标点符号(含空格)"></a>除保留标点符号集以外，清除其他所有英文的标点符号(含空格)</h2><p>全部英文标点符号为：~`!@#$%^&amp;*()-_+=[]{};:”‘,&lt;.&gt;/?</p>
<p>参数excludePunctuation指需要保留的标点符号集，例如若传递的值为’_’，即表示清除_以外的其他所有英文标点符号。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearPunctuation</span>(<span class="params">str,excludePunctuation=null</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> regexp = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`[<span class="subst">$&#123;getExcludePunctuation(excludePunctuation)&#125;</span>]`</span>,<span class="string">'g'</span>);</span><br><span class="line">    <span class="keyword">return</span> str.replace(regexp,<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否包含空格"><a href="#校验是否包含空格" class="headerlink" title="校验是否包含空格"></a>校验是否包含空格</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">haveSpace</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/[ ]/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="校验是否包含中文字符-包括中文标点符号"><a href="#校验是否包含中文字符-包括中文标点符号" class="headerlink" title="校验是否包含中文字符(包括中文标点符号)"></a>校验是否包含中文字符(包括中文标点符号)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">haveCNChars</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/[\u4e00-\u9fa5]/</span>.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/iview源码修改/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/iview源码修改/" class="post-title-link" itemprop="url">iview源码修改</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 18:58:39 / 修改时间：22:29:42" itemprop="dateCreated datePublished" datetime="2020-06-27T18:58:39+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="iview-源码修改"><a href="#iview-源码修改" class="headerlink" title="iview 源码修改"></a><code>iview</code> 源码修改</h1><p><code>iview</code> 组件库在 <code>3.6.5</code> 版本之前的 <code>DatePicker</code> 组件都是存在 <code>bug</code> 的。</p>
<p><code>iview</code> 修改源码<a href="https://juejin.im/post/5d089ffef265da1b614ffa07" target="_blank" rel="noopener">https://juejin.im/post/5d089ffef265da1b614ffa07</a>   </p>
<p> 可以将<code>iview</code>项目<code>clone</code>下来，然后执行 <code>npm i</code> 安装完对应的依赖之后，修改代码，修改完之后执行 <code>npm run prepare</code>  打包到 <code>dist</code> 目录中，然后将 <code>dist</code> 中的  <code>iview</code>  文件拷贝到 项目中  <code>node_modules</code> 中的 <code>iview</code> 对应目录中的 </p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/transform属性的若干问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/transform属性的若干问题/" class="post-title-link" itemprop="url">transform属性的若干问题</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 17:48:26 / 修改时间：22:29:28" itemprop="dateCreated datePublished" datetime="2020-06-27T17:48:26+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="transform-属性的若干问题"><a href="#transform-属性的若干问题" class="headerlink" title="transform 属性的若干问题"></a>transform 属性的若干问题</h1><h2 id="动画库"><a href="#动画库" class="headerlink" title="动画库"></a>动画库</h2><p>到现在来说css3动画也不是什么新技术，既然是要搞定它，好歹我们也得先看下别人做的一些东西吧，所以在此先向各位推荐几个比较好用的动画库：</p>
<ul>
<li><a href="https://github.com/daneden/animate.css/" target="_blank" rel="noopener">animate.css</a></li>
<li><a href="http://h5bp.github.io/Effeckt.css/" target="_blank" rel="noopener">effeckt</a></li>
<li><a href="http://ianlunn.github.io/Hover/" target="_blank" rel="noopener">hover.css</a></li>
<li><a href="http://leaverou.github.io/animatable/" target="_blank" rel="noopener">animatable</a></li>
</ul>
<h2 id="关于css3动画不得不说的几个属性"><a href="#关于css3动画不得不说的几个属性" class="headerlink" title="关于css3动画不得不说的几个属性"></a>关于css3动画不得不说的几个属性</h2><p>看完上面那些动画库，心痒就不如行动了。</p>
<p>说起css3动画，有一个属性我们绝对避不开了，那就是<code>transform</code>这个属性，而如果要搞点高级的3d特效，那还有两个比较容易混淆的东西<code>perspective</code>和<code>preserve-3d</code>，下面我们简单说明关于这些的一些疑难点。</p>
<h3 id="transform"><a href="#transform" class="headerlink" title="transform"></a>transform</h3><p>1、任何非none值的transform会导致创建一个堆栈上下文和包含块。</p>
<p>所以如果父级元素设置了transform属性，<code>position:relative/absolute/fixed</code>会基于此定位，详细请参考：<a href="http://meyerweb.com/eric/thoughts/2011/09/12/un-fixing-fixed-elements-with-css-transforms/" target="_blank" rel="noopener">transformed element creates a containing block for all its positioned descendants</a></p>
<p><a href="http://jsbin.com/yiyoji" target="_blank" rel="noopener">demo</a>如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.demo</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">100px</span>,<span class="number">100px</span>);</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.child</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、transform属性值覆盖问题</p>
<p>我们知道transform可以有四个不同的变换，分别为<code>scale</code>、<code>translate</code>、<code>skew</code>、<code>rotate</code>。现在的问题是当有两个transform设置不同变换时，权重大的覆盖权重小的。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.demo</span>&#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.demo</span>&#123;</span><br><span class="line">    // 第一条scale将会被覆盖，失效</span><br><span class="line">    <span class="selector-tag">transform</span>: <span class="selector-tag">translateX</span>(50<span class="selector-tag">px</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 如果要包含第一条scale</span><br><span class="line"><span class="selector-class">.demo</span>&#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2</span>) <span class="built_in">translateX</span>(<span class="number">50px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个问题在平时使用中还好，但是在动画中那就相当麻烦了，因为你必须还得去拷贝之前设置的值。<strong>所以水平垂直居中的弹窗如果用了translate水平定位，然后再使用transform动画，那就毁了。</strong></p>
<p>注： 听说谷歌正在拆分这四个值，这样就简单多了。</p>
<p>3、transform几个值的先后问题</p>
<p>对不起，那四个值的真的不是随便写的，它是有先后的。第一会改变中心点，第二会改变坐标系，所以请遵循先后顺序。以立方体为例：</p>
<p><a href="http://desandro.github.io/3dtransforms/examples/cube-02-show-sides.html" target="_blank" rel="noopener">cube demo</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"cube"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">figure</span> <span class="attr">class</span>=<span class="string">"front"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">figure</span> <span class="attr">class</span>=<span class="string">"back"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">figure</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">figure</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span>4<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">figure</span> <span class="attr">class</span>=<span class="string">"top"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">figure</span> <span class="attr">class</span>=<span class="string">"bottom"</span>&gt;</span>6<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.front</span>  &#123; <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(   <span class="number">0deg</span> ) <span class="built_in">translateZ</span>( <span class="number">100px</span> ); &#125;</span><br><span class="line"><span class="selector-class">.back</span>   &#123; <span class="attribute">transform</span>: <span class="built_in">rotateX</span>( <span class="number">180deg</span> ) <span class="built_in">translateZ</span>( <span class="number">100px</span> ); &#125;</span><br><span class="line"><span class="selector-class">.right</span>  &#123; <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(  <span class="number">90deg</span> ) <span class="built_in">translateZ</span>( <span class="number">100px</span> ); &#125;</span><br><span class="line"><span class="selector-class">.left</span>   &#123; <span class="attribute">transform</span>: <span class="built_in">rotateY</span>( -<span class="number">90deg</span> ) <span class="built_in">translateZ</span>( <span class="number">100px</span> ); &#125;</span><br><span class="line"><span class="selector-class">.top</span>    &#123; <span class="attribute">transform</span>: <span class="built_in">rotateX</span>(  <span class="number">90deg</span> ) <span class="built_in">translateZ</span>( <span class="number">100px</span> ); &#125;</span><br><span class="line"><span class="selector-class">.bottom</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotateX</span>( -<span class="number">90deg</span> ) <span class="built_in">translateZ</span>( <span class="number">100px</span> ); &#125;</span><br></pre></td></tr></table></figure>

<p>可以看到在设置六个面的时候，我们是先旋转（改变了坐标系），然后通过translateZ定位即可。这就跟我们军训的时候站军姿一样，每转动一次，我们的坐标随即改变，如向左转，转完之后就不再是左而是我们的正前方了。</p>
<h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><p>上面说了那么多疑难点，算是为我们的动画铺平了一些道路，现在正式进入我们的动画。</p>
<h3 id="transition"><a href="#transition" class="headerlink" title="transition"></a>transition</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transition</span>: <span class="selector-attr">[property]</span> <span class="selector-attr">[duration]</span> <span class="selector-attr">[timing-function]</span> <span class="selector-attr">[delay]</span>;</span><br></pre></td></tr></table></figure>

<p>1、不可自动触发，可以通过改变class，改变状态(:hover, :active, :checked等)触发</p>
<p>2、display的none与其他值的切换不行， 通过delay设置也不行，除非通过回调函数或setTimeout先切换display，再设置动画样式改变。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.demo</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    transition: width .3s; // 在none和其他值之间切换，动画无效</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.demo</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、可设置delay为负值，表示动画已经运行到了该时间，前面的动画效果忽略，见<a href="http://jsbin.com/bureyo" target="_blank" rel="noopener">demo</a></p>
<p>4、可对自己或子元素进行动画动画: <a href="http://in-ni.com/?mc_cid=89bb4f01b6&mc_eid=38ec57e264" target="_blank" rel="noopener">combined transitions 1</a></p>
<p>5、或对同级下面的元素及其子元素进行动画控制: <a href="http://codepen.io/suez/pen/XJGOyL?mc_cid=89bb4f01b6&mc_eid=38ec57e264" target="_blank" rel="noopener">combined transitions 2</a></p>
<p>6、可在状态内添加transition，覆盖默认的transition，见<a href="http://jsbin.com/tajaki" target="_blank" rel="noopener">demo</a></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 鼠标滑过会采用hover的transition即1s（覆盖了默认的transition），滑出会采用默认的transition即5s</span><br><span class="line"><span class="selector-class">.demo</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.demo</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">1s</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="animation"><a href="#animation" class="headerlink" title="animation"></a>animation</h3><p>语法：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">animation: [[@keyframes](/user/keyframes) name] [duration] [timing-function] [delay] </span><br><span class="line"><span class="selector-attr">[iteration-count]</span> <span class="selector-attr">[direction]</span> <span class="selector-attr">[fill-mode]</span> <span class="selector-attr">[play-state]</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">animation</span>: <span class="selector-tag">slidein</span> 3<span class="selector-tag">s</span> <span class="selector-tag">ease-in</span> 1<span class="selector-tag">s</span> 2 <span class="selector-tag">reverse</span> <span class="selector-tag">both</span> <span class="selector-tag">paused</span>;</span><br></pre></td></tr></table></figure>

<p>1、可自动触发，也可以通过状态或增加class触发</p>
<p>2、安卓低端机不支持伪元素（<code>::before</code>和<code>::after</code>）动画</p>
<p>3、animation-fill-mode 可设置动画结束及开始的状态。如为backwards，则元素默认应用第一关键帧的样式，忽略delay，可通过一开始就暂停观察（animation-play-state: paused;）；如为forwards，则在动画结束后，元素将应用动画结束后的属性值；如果animation-fill-mode的值为both，则动画会遵循backwards和forwards的规则。也就是说，它会设置开始和结束的状态。</p>
<p>4、animation-timing-function默认应用在每个关键帧之间的变化，而不是开始到结束整个流程。所以<a href="https://imweb.io/user/keyframes" target="_blank" rel="noopener">@keyframes</a> 中的每个关键帧可以重新定义animation-timing-function</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[@keyframes](/user/keyframes) square &#123; </span><br><span class="line">   50% &#123;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">200px</span>;</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">400px</span>;</span><br><span class="line">      <span class="attribute">animation-timing-function</span>: ease-in-out;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5、可以用于none到block的动画切换</p>
<p>查看<a href="http://jsbin.com/fapava" target="_blank" rel="noopener">demo</a>，主要代码如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// child一开始为none，demo hover的时候使用动画显示</span><br><span class="line"><span class="selector-class">.demo</span> <span class="selector-class">.child</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.demo</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.child</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">animation</span>: showChild .<span class="number">3s</span> both;</span><br><span class="line">&#125;</span><br><span class="line">[@keyframes](/user/keyframes) showChild &#123;</span><br><span class="line">    <span class="selector-tag">from</span>&#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>6、对于关键帧的安排是门技术活，所以这里推荐使用<a href="http://tid.tenpay.com/labs/css3_keyframes_calculator.html" target="_blank" rel="noopener">CSS3动画帧数计算器</a></p>
<h3 id="动画js事件"><a href="#动画js事件" class="headerlink" title="动画js事件"></a>动画js事件</h3><p>1、<code>transition</code>动画只有一个<code>transitionend</code>事件，而webkit现在既支持webkitTransitionEnd，也支持标准的transitionend事件，所以只能绑定一个，不然会触发两次事件，见<a href="http://jsbin.com/xosigi/1" target="_blank" rel="noopener">demo</a></p>
<p>2、如有多个属性参与动画，就会出现多个<code>transitionend</code>事件（这个事件标准还是有不少bug的），所以请使用jquery的one事件，或者绑定事件调用函数中随即取消绑定事件</p>
<p>3、<a href="https://jonsuh.com/blog/detect-the-end-of-css-animations-and-transitions-with-javascript/" target="_blank" rel="noopener">Detect the End of CSS Animations and Transitions with JavaScript</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">whichTransitionEvent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> t,</span><br><span class="line">      el = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> transitions = &#123;</span><br><span class="line">    <span class="string">"transition"</span>      : <span class="string">"transitionend"</span>,</span><br><span class="line">    <span class="string">"MozTransition"</span>   : <span class="string">"transitionend"</span>,</span><br><span class="line">    <span class="string">"WebkitTransition"</span>: <span class="string">"webkitTransitionEnd"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (t <span class="keyword">in</span> transitions)&#123;</span><br><span class="line">    <span class="keyword">if</span> (el.style[t] !== <span class="literal">undefined</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> transitions[t];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> transitionEvent = whichTransitionEvent();</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jquery 调用</span></span><br><span class="line">$(<span class="string">".button"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  $(<span class="keyword">this</span>).addClass(<span class="string">"animate"</span>);</span><br><span class="line">  $(<span class="keyword">this</span>).one(transitionEvent,</span><br><span class="line">              <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Do something when the transition ends</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 原生js调用</span></span><br><span class="line"><span class="keyword">var</span> button = <span class="built_in">document</span>.querySelector(<span class="string">".button"</span>),</span><br><span class="line">    transitionEvent = whichTransitionEvent();</span><br><span class="line"></span><br><span class="line">button.addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (button.classList) &#123;</span><br><span class="line">    button.classList.add(<span class="string">"animate"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    button.className += <span class="string">" "</span> + <span class="string">"animate"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  button.addEventListener(transitionEvent, customFunction);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">customFunction</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  button.removeEventListener(transitionEvent, customFunction);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Do something when the transition ends</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、<code>animation</code>动画有三个js事件，分别为<code>animationstart</code>、<code>animationiteration</code>、<code>animationend</code></p>
<h3 id="不支持的动画属性切换"><a href="#不支持的动画属性切换" class="headerlink" title="不支持的动画属性切换"></a>不支持的动画属性切换</h3><ul>
<li>background-image</li>
<li>float</li>
<li>height/width/top/right/bottom/left 等auto值向具体值的变换</li>
<li>display 在none和其他值之间切换</li>
<li>position 在static和absolute之间切换</li>
</ul>
<h3 id="timing-function"><a href="#timing-function" class="headerlink" title="timing-function"></a>timing-function</h3><p>1、<code>cubic-bezier(x1, y1, x2, y2)</code>，标准四个数字的取值范围为[0,1]，但是各个浏览器的范围有所不同，chrome浏览器就允许弹性效果，如<code>cubic-bezier(.62,-0.32,.29,1.46)</code></p>
<p><a href="http://cubic-bezier.com/" target="_blank" rel="noopener">在线Cubic Bezier编辑</a></p>
<p>2、 steps()</p>
<p>步骤动画，规定几步完成，每步完成时间(t)为总时间(T)/步骤(n)，分为start和end两种。start表示每步完成时间的开始就已经运动了，end表示每步完成时间结束才运动。</p>
<p><strong>需要额外注意的是：当存在定位元素的时候，如果定位元素的参照元素使用了 <code>transform</code> 属性的话，那么定位元素就会依照该 <code>transform</code> 的元素进行定位。</strong></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="https://niuxinyu.github.io/niuxinyublog/niuxinyublog/2020/06/27/理解vue中的key/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Niu">
      <meta itemprop="description" content="文章">
      <meta itemprop="image" content="/niuxinyublog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niu的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/niuxinyublog/2020/06/27/理解vue中的key/" class="post-title-link" itemprop="url">理解vue中的key</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-06-27 17:47:06 / 修改时间：22:29:20" itemprop="dateCreated datePublished" datetime="2020-06-27T17:47:06+08:00">2020-06-27</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="如何理解vue中的key？"><a href="#如何理解vue中的key？" class="headerlink" title="如何理解vue中的key？"></a>如何理解vue中的key？</h1><p>就目前所了解的情况，key的作用有以下这些。</p>
<ul>
<li>v-for遍历时，用id，uuid之类作为key，唯一标识节点加速虚拟DOM渲染</li>
<li>响应式系统没有监听到的数据，用+new Date()生成的时间戳作为key，手动强制触发重新渲染</li>
</ul>
<p>场景一大同小异司空见惯，场景二是下面这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div :key=&quot;rerender&quot;&gt;</span><br><span class="line">    &lt;span&gt;Hello Vue.js !&lt;/span&gt;</span><br><span class="line">    &lt;complexComponent :propObj=&quot;propObj&quot; :propArr=&quot;propArr&quot; &gt;&lt;/complexComponent&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">refresh()&#123;</span><br><span class="line">    this.rerender = + new Date();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么vue中key的相关知识点到底是怎样的呢？</p>
<ul>
<li>官方API知识点</li>
<li>上面2个使用场景背后的原理是什么？</li>
<li>除key外，还有其它强制更新DOM的方法吗？</li>
</ul>
<h3 id="官方API知识点"><a href="#官方API知识点" class="headerlink" title="官方API知识点"></a>官方API知识点</h3><ul>
<li>在Vue.js中，key是6个特殊属性key, ref, is, slot, slot-scope, scope其中之一。</li>
<li>key的值可以是number，也可以是string。</li>
<li>key主要作用于Vue的virtual DOM算法，在diff new nodes list和old nodes list时，作为识别VNode的一个线索。</li>
<li>如果不用key，Vue会用一种算法：最小化element的移动，并且会尝试尽最大程度在同适当的地方对相同类型的element，做patch或者reuse。</li>
<li>如果使用了key，Vue会根据keys的顺序记录element，<strong>曾经拥有了key的element如果不再出现的话，会被直接remove或者destoryed。</strong></li>
<li>拥有同一个parent的children必须有unique keys。重复的key的导致render error。</li>
</ul>
<h4 id="最常用的用法一：v-for"><a href="#最常用的用法一：v-for" class="headerlink" title="最常用的用法一：v-for"></a>最常用的用法一：v-for</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li v-for=&quot;item in items&quot; :key=&quot;item.id&quot;&gt;...&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>

<h4 id="最常用的用法二：强制替换element或者component"><a href="#最常用的用法二：强制替换element或者component" class="headerlink" title="最常用的用法二：强制替换element或者component"></a>最常用的用法二：强制替换element或者component</h4><ul>
<li>触发组件的lifecycle</li>
<li>触发transition</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition&gt;</span><br><span class="line">  &lt;span :key=&quot;text&quot;&gt;&#123;&#123; text &#125;&#125;&lt;/span&gt;</span><br><span class="line">&lt;/transition&gt;</span><br></pre></td></tr></table></figure>

<p>text发生变化时，<code>&lt;span&gt;</code>会被replaced，而不会patched，因此transition会被触发。 我的理解： <strong>text变化时，span的key发生了变化，也就是说曾经拥有了旧key的span不再出现了，当拥有新值的text作为key时，拥有了新key的span出现了，那么旧key span会被移除，旧transition也会移除，新key span触发渲染，新transition触发。</strong></p>
<h3 id="上面2个使用场景背后的原理是什么？"><a href="#上面2个使用场景背后的原理是什么？" class="headerlink" title="上面2个使用场景背后的原理是什么？"></a>上面2个使用场景背后的原理是什么？</h3><p>结合官方API的知识点，现在再来回顾文章开头提出的场景。</p>
<h4 id="场景一：v-for遍历时，用id，uuid之类作为key，唯一标识节点加速虚拟DOM渲染"><a href="#场景一：v-for遍历时，用id，uuid之类作为key，唯一标识节点加速虚拟DOM渲染" class="headerlink" title="场景一：v-for遍历时，用id，uuid之类作为key，唯一标识节点加速虚拟DOM渲染"></a>场景一：v-for遍历时，用id，uuid之类作为key，唯一标识节点加速虚拟DOM渲染</h4><p>答案：</p>
<ul>
<li>如果不用key，Vue会用一种算法：最小化element的移动，并且会尝试尽最大程度在同适当的地方对相同类型的element，做patch或者reuse。</li>
<li>如果使用了key，Vue会根据keys的顺序记录element，<strong>曾经拥有了key的element如果不再出现的话，会被直接remove或者destoryed。</strong></li>
</ul>
<h4 id="场景二：响应式系统没有监听到的数据，用-new-Date-生成的时间戳作为key，手动强制触发重新渲染"><a href="#场景二：响应式系统没有监听到的数据，用-new-Date-生成的时间戳作为key，手动强制触发重新渲染" class="headerlink" title="场景二：响应式系统没有监听到的数据，用+new Date()生成的时间戳作为key，手动强制触发重新渲染"></a>场景二：响应式系统没有监听到的数据，用+new Date()生成的时间戳作为key，手动强制触发重新渲染</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div :key=&quot;rerender&quot;&gt;</span><br><span class="line">    &lt;span&gt;Hello Vue.js !&lt;/span&gt;</span><br><span class="line">    &lt;complexComponent :propObj=&quot;propObj&quot; :propArr=&quot;propArr&quot; &gt;&lt;/complexComponent&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">refresh()&#123;</span><br><span class="line">    this.rerender = + new Date();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>答案：</p>
<ul>
<li>如果使用了key，Vue会根据keys的顺序记录element，<strong>曾经拥有了key的element如果不再出现的话，会被直接remove或者destoryed。</strong></li>
<li>refresh方法调用后，包含了span和complexComponent的div的key发生了变化，也就是说曾经拥有了旧key的div不再出现了，当拥有新值的rerender作为key时，拥有了新key的div出现了，那么旧key div会被移除，旧span和complexComponent也会移除，新key div触发渲染，新span，<strong>带着父组件新propObj和propArr的新complexComponent渲染。</strong></li>
</ul>
<p>思考：</p>
<ol>
<li>为什么要叫propObj和propArr？</li>
<li><strong>带着父组件新propObj和propArr的新complexComponent渲染。</strong> 为什么要加粗？</li>
</ol>
<p>由于Vue.js的obj和arr存在无法检测到数据变化的情况，obj是属性的新增和删除（原因是新增和删除都没有触发setter，watcher未告诉外界更新），arr则是数组内元素重新赋值或者修改length属性（原因是没有使用改变数组本身的方法，没有触发数组原型链拦截器，watcher未告诉外界更新）。 所以！通过赋予新key的方式，移除旧key div，渲染新key div，propObj和propArr在complexComponent组件内会重新触发一次生命周期，做一次重新渲染。<strong>此时父组件的propObj和propArr js变量其实已经获取到新值了，只是没有触发DOM也好，VNode也好的重新渲染。</strong>需要通过刷新key去force update，说到forceUpdate，可以通过$forceUpdate()去手动强制更新DOM。</p>
<h3 id="除key外，还有其它强制更新DOM的方法吗？"><a href="#除key外，还有其它强制更新DOM的方法吗？" class="headerlink" title="除key外，还有其它强制更新DOM的方法吗？"></a>除key外，还有其它强制更新DOM的方法吗？</h3><p>场景：父组件修改传递给子组件的数据，数组数据的更新没有按照this.$set去更新。该怎么办？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.productImages.forEach(<span class="function">(<span class="params">product</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (product.productId <span class="keyword">in</span> <span class="keyword">this</span>.productsState) &#123;</span><br><span class="line">    product.status = <span class="keyword">this</span>.productsState[product.productId];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>不使用this.$set去赋值数据的不能rerender的原因是什么？</strong> 在Vue.js中，对Array的变化侦测是通过拦截原型的方式实现的。也就通过对push，pop，shift，unshift，splice，sort，reverse，fill，copyWithin去改变数组自身内容的方法做拦截，从而响应。而<code>product.status = this.productsState[product.productId];</code>没有触发任何改变数组自身的被监听的方法，因此不会rerender。</p>
<ul>
<li>刷新组件的key</li>
<li>$forceUpdate方法</li>
</ul>
<h4 id="刷新组件的key"><a href="#刷新组件的key" class="headerlink" title="刷新组件的key"></a>刷新组件的key</h4><h5 id="1-这个key加在什么地方比较好？"><a href="#1-这个key加在什么地方比较好？" class="headerlink" title="1.这个key加在什么地方比较好？"></a>1.这个key加在什么地方比较好？</h5><p>加在this.productImages的父元素上就好。 若不涉及数据传递，也可以直接加在需要更新的element上。</p>
<h5 id="2-用什么做key值？"><a href="#2-用什么做key值？" class="headerlink" title="2.用什么做key值？"></a>2.用什么做key值？</h5><p>现在是粗暴的+new Date()时间戳做key值的。 也可以用双向绑定的值作为key值，保证新旧key值不同就行。</p>
<h5 id="3-key的原理是什么？"><a href="#3-key的原理是什么？" class="headerlink" title="3.key的原理是什么？"></a>3.key的原理是什么？</h5><p>vue.js的虚拟DOM算法，在更新vNode时，需要从旧vNode列表中查找与新vNode节点相同的vNode进行更新，如果这个过程设置了属性key，过程就会快很多。 其他具体见上文。</p>
<h4 id="forceUpdate方法"><a href="#forceUpdate方法" class="headerlink" title="$forceUpdate方法"></a>$forceUpdate方法</h4><p><strong>只能在父组件调用这个方法，手动通知vue实例重新渲染。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// $forceUpdate源码</span></span><br><span class="line">Vue.prototype.$forceUpdate = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> vm: Component = <span class="keyword">this</span></span><br><span class="line">  <span class="keyword">if</span> (vm._watcher) &#123;</span><br><span class="line">    vm._watcher.update()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// update源码</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Subscriber interface.</span></span><br><span class="line"><span class="comment"> * Will be called when a dependency changes.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">update () &#123;</span><br><span class="line">  <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.lazy) &#123;</span><br><span class="line">    <span class="keyword">this</span>.dirty = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.sync) &#123;</span><br><span class="line">    <span class="keyword">this</span>.run()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    queueWatcher(<span class="keyword">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-forceUpdate可以更新的原理分析"><a href="#1-forceUpdate可以更新的原理分析" class="headerlink" title="1.$forceUpdate可以更新的原理分析"></a>1.$forceUpdate可以更新的原理分析</h5><p><code>product.status = this.productsState[product.productId];</code>以后，<strong>其实此时dep已经发生变化了</strong>，但是Vue.js数组响应式的实现由于是拦截原型链方法的方式，没有检测到这个变化，所以不会自动rerender，没有触发update。因此我们<strong>通过$forceUpdate的方式，调用包含dep的watcher上的update方法，从而做到rerender</strong>。</p>
<h5 id="2-可以在子组件监听事件，父组件发送事件然后只刷新子组件吗？"><a href="#2-可以在子组件监听事件，父组件发送事件然后只刷新子组件吗？" class="headerlink" title="2.可以在子组件监听事件，父组件发送事件然后只刷新子组件吗？"></a>2.可以在子组件监听事件，父组件发送事件然后只刷新子组件吗？</h5><p>不可以。 因为dep是父组件的watcher和dep，并不是子组件，是父组件的this.productImages没有被检测到并实时更新，并不是子组件的问题。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/niuxinyublog/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/niuxinyublog/">1</a><span class="page-number current">2</span><a class="page-number" href="/niuxinyublog/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/niuxinyublog/page/8/">8</a><a class="extend next" rel="next" href="/niuxinyublog/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Niu</p>
  <div class="site-description" itemprop="description">文章</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/niuxinyublog/archives/">
        
          <span class="site-state-item-count">77</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">标签</span>
        
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Niu</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/niuxinyublog/lib/anime.min.js?v=3.1.0"></script>
  <script src="/niuxinyublog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/niuxinyublog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/niuxinyublog/js/utils.js?v=7.4.0"></script><script src="/niuxinyublog/js/motion.js?v=7.4.0"></script>
<script src="/niuxinyublog/js/schemes/pisces.js?v=7.4.0"></script>

<script src="/niuxinyublog/js/next-boot.js?v=7.4.0"></script>



  





















  

  

  

</body>
</html>
